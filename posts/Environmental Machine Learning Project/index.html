<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Megan Tieu">
<meta name="dcterms.date" content="2025-04-21">

<title>Environmental Data Project – mlresearch</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">mlresearch</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Environmental Data Project</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Megan Tieu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 21, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="machine-learning-project" class="level1">
<h1>Machine Learning Project</h1>
</section>
<section id="week-one-goals" class="level1">
<h1>Week one goals</h1>
<ul>
<li>Create Github repository</li>
<li>Connect it to Quarto Blog</li>
<li>Find potential datasets</li>
<li>Import data</li>
<li>Preliminary data cleaning and preparing</li>
<li>Create research questions that can be answered using data analysis, visualizations, and machine learning</li>
<li>Figure out what tools and packages to be used</li>
</ul>
<section id="github-repository" class="level2">
<h2 class="anchored" data-anchor-id="github-repository">GitHub Repository</h2>
<p><a href="https://github.com/megaminding/machine_learning_research">Here’s a link to the GitHub repo</a></p>
</section>
<section id="dataset" class="level2">
<h2 class="anchored" data-anchor-id="dataset">Dataset</h2>
<p>Before choosing a specific topic, I did data exploration for various datasets to see which would be the most interesting. I looked at: - US Census https://github.com/zykls/folktablesLinks - Covid19 - https://www.kaggle.com/imdevskp/covid-19-analysis-visualization-comparisons/dataLink - Uber: https://www.kaggle.com/datasets/yasserh/uber-fares-dataset - NYC: https://data.cityofnewyork.us/browse?category=Transportation</p>
</section>
<section id="environmental-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="environmental-data-analysis">Environmental Data Analysis</h2>
<ul>
<li>“How have land use, air quality, disasters, and climate variables changed over time? What factors are related to this?”</li>
<li>Created an account with Public EM-DAT to access a global database on natural and technological disasters</li>
<li><img src="Screenshot 2025-04-22 at 12.25.46 PM.png" alt="User submitting message 'Happy Valentines Day' by user Megan Elizabeth Tieu" height="300"></li>
<li>Configured parameters to obtain custom dataset</li>
<li><img src="Screenshot 2025-04-21 at 6.21.45 PM.png" alt="User submitting message 'Happy Valentines Day' by user Megan Elizabeth Tieu" height="300"></li>
</ul>
<div id="7f5b976d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">"emdat.xlsx"</span>, engine<span class="op">=</span><span class="st">"openpyxl"</span>)  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          DisNo. Historic Classification Key Disaster Group Disaster Subgroup  \
0  1999-9388-DJI       No    nat-cli-dro-dro        Natural    Climatological   
1  1999-9388-SDN       No    nat-cli-dro-dro        Natural    Climatological   
2  1999-9388-SOM       No    nat-cli-dro-dro        Natural    Climatological   
3  2000-0001-AGO       No    tec-tra-roa-roa  Technological         Transport   
4  2000-0002-AGO       No    nat-hyd-flo-riv        Natural      Hydrological   

  Disaster Type Disaster Subtype External IDs Event Name  ISO  ...  \
0       Drought          Drought          NaN        NaN  DJI  ...   
1       Drought          Drought          NaN        NaN  SDN  ...   
2       Drought          Drought          NaN        NaN  SOM  ...   
3          Road             Road          NaN        NaN  AGO  ...   
4         Flood   Riverine flood          NaN        NaN  AGO  ...   

  Reconstruction Costs ('000 US$) Reconstruction Costs, Adjusted ('000 US$)  \
0                             NaN                                       NaN   
1                             NaN                                       NaN   
2                             NaN                                       NaN   
3                             NaN                                       NaN   
4                             NaN                                       NaN   

  Insured Damage ('000 US$) Insured Damage, Adjusted ('000 US$)  \
0                       NaN                                 NaN   
1                       NaN                                 NaN   
2                       NaN                                 NaN   
3                       NaN                                 NaN   
4                       NaN                                 NaN   

  Total Damage ('000 US$) Total Damage, Adjusted ('000 US$)        CPI  \
0                     NaN                               NaN  58.111474   
1                     NaN                               NaN  56.514291   
2                     NaN                               NaN  56.514291   
3                     NaN                               NaN  56.514291   
4                 10000.0                           17695.0  56.514291   

                                         Admin Units  Entry Date  Last Update  
0  [{"adm1_code":1093,"adm1_name":"Ali Sabieh"},{...  2006-03-01   2023-09-25  
1  [{"adm1_code":2757,"adm1_name":"Northern Darfu...  2006-03-08   2023-09-25  
2  [{"adm1_code":2691,"adm1_name":"Bay"},{"adm1_c...  2006-03-08   2023-09-25  
3                                                NaN  2004-10-27   2023-09-25  
4  [{"adm2_code":4214,"adm2_name":"Baia Farta"},{...  2005-02-03   2023-09-25  

[5 rows x 46 columns]</code></pre>
</div>
</div>
<p>Let’s inspect the data</p>
<div id="23ec5554" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.info()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 16209 entries, 0 to 16208
Data columns (total 46 columns):
 #   Column                                     Non-Null Count  Dtype  
---  ------                                     --------------  -----  
 0   DisNo.                                     16209 non-null  object 
 1   Historic                                   16209 non-null  object 
 2   Classification Key                         16209 non-null  object 
 3   Disaster Group                             16209 non-null  object 
 4   Disaster Subgroup                          16209 non-null  object 
 5   Disaster Type                              16209 non-null  object 
 6   Disaster Subtype                           16209 non-null  object 
 7   External IDs                               2709 non-null   object 
 8   Event Name                                 5105 non-null   object 
 9   ISO                                        16209 non-null  object 
 10  Country                                    16209 non-null  object 
 11  Subregion                                  16209 non-null  object 
 12  Region                                     16209 non-null  object 
 13  Location                                   15499 non-null  object 
 14  Origin                                     4076 non-null   object 
 15  Associated Types                           3438 non-null   object 
 16  OFDA/BHA Response                          16209 non-null  object 
 17  Appeal                                     16209 non-null  object 
 18  Declaration                                16209 non-null  object 
 19  AID Contribution ('000 US$)                489 non-null    float64
 20  Magnitude                                  3311 non-null   float64
 21  Magnitude Scale                            10137 non-null  object 
 22  Latitude                                   1816 non-null   float64
 23  Longitude                                  1816 non-null   float64
 24  River Basin                                1233 non-null   object 
 25  Start Year                                 16209 non-null  int64  
 26  Start Month                                16140 non-null  float64
 27  Start Day                                  14638 non-null  float64
 28  End Year                                   16209 non-null  int64  
 29  End Month                                  16046 non-null  float64
 30  End Day                                    14710 non-null  float64
 31  Total Deaths                               13039 non-null  float64
 32  No. Injured                                6019 non-null   float64
 33  No. Affected                               7503 non-null   float64
 34  No. Homeless                               1333 non-null   float64
 35  Total Affected                             12087 non-null  float64
 36  Reconstruction Costs ('000 US$)            33 non-null     float64
 37  Reconstruction Costs, Adjusted ('000 US$)  33 non-null     float64
 38  Insured Damage ('000 US$)                  713 non-null    float64
 39  Insured Damage, Adjusted ('000 US$)        694 non-null    float64
 40  Total Damage ('000 US$)                    3237 non-null   float64
 41  Total Damage, Adjusted ('000 US$)          3110 non-null   float64
 42  CPI                                        15527 non-null  float64
 43  Admin Units                                8416 non-null   object 
 44  Entry Date                                 16209 non-null  object 
 45  Last Update                                16209 non-null  object 
dtypes: float64(20), int64(2), object(24)
memory usage: 5.7+ MB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">AID Contribution ('000 US$)</th>
<th data-quarto-table-cell-role="th">Magnitude</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Start Year</th>
<th data-quarto-table-cell-role="th">Start Month</th>
<th data-quarto-table-cell-role="th">Start Day</th>
<th data-quarto-table-cell-role="th">End Year</th>
<th data-quarto-table-cell-role="th">End Month</th>
<th data-quarto-table-cell-role="th">End Day</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">No. Affected</th>
<th data-quarto-table-cell-role="th">No. Homeless</th>
<th data-quarto-table-cell-role="th">Total Affected</th>
<th data-quarto-table-cell-role="th">Reconstruction Costs ('000 US$)</th>
<th data-quarto-table-cell-role="th">Reconstruction Costs, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">Insured Damage ('000 US$)</th>
<th data-quarto-table-cell-role="th">Insured Damage, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">Total Damage ('000 US$)</th>
<th data-quarto-table-cell-role="th">Total Damage, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>4.890000e+02</td>
<td>3.311000e+03</td>
<td>1816.000000</td>
<td>1816.000000</td>
<td>16209.000000</td>
<td>16140.000000</td>
<td>14638.000000</td>
<td>16209.000000</td>
<td>16046.000000</td>
<td>14710.000000</td>
<td>...</td>
<td>7.503000e+03</td>
<td>1.333000e+03</td>
<td>1.208700e+04</td>
<td>3.300000e+01</td>
<td>3.300000e+01</td>
<td>7.130000e+02</td>
<td>6.940000e+02</td>
<td>3.237000e+03</td>
<td>3.110000e+03</td>
<td>15527.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2.855916e+04</td>
<td>6.122545e+04</td>
<td>16.415862</td>
<td>42.477620</td>
<td>2011.109816</td>
<td>6.463755</td>
<td>15.352849</td>
<td>2011.141156</td>
<td>6.592858</td>
<td>15.814276</td>
<td>...</td>
<td>6.280205e+05</td>
<td>3.162704e+04</td>
<td>3.939913e+05</td>
<td>5.687264e+06</td>
<td>6.357118e+06</td>
<td>1.347736e+06</td>
<td>1.699765e+06</td>
<td>1.178820e+06</td>
<td>1.478426e+06</td>
<td>72.858610</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2.118956e+05</td>
<td>7.486415e+05</td>
<td>21.786044</td>
<td>75.523526</td>
<td>7.422845</td>
<td>3.413559</td>
<td>8.973253</td>
<td>7.425922</td>
<td>3.391621</td>
<td>8.891107</td>
<td>...</td>
<td>6.649927e+06</td>
<td>2.143536e+05</td>
<td>5.249462e+06</td>
<td>1.745232e+07</td>
<td>1.760343e+07</td>
<td>4.644761e+06</td>
<td>5.954430e+06</td>
<td>6.317104e+06</td>
<td>8.316465e+06</td>
<td>11.582942</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>3.000000e+00</td>
<td>-5.700000e+01</td>
<td>-72.640000</td>
<td>-172.095000</td>
<td>2000.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>2000.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>...</td>
<td>1.000000e+00</td>
<td>3.000000e+00</td>
<td>1.000000e+00</td>
<td>8.400000e+01</td>
<td>1.310000e+02</td>
<td>3.400000e+01</td>
<td>4.800000e+01</td>
<td>2.000000e+00</td>
<td>3.000000e+00</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>1.660000e+02</td>
<td>2.350000e+01</td>
<td>1.061500</td>
<td>1.676500</td>
<td>2005.000000</td>
<td>4.000000</td>
<td>7.000000</td>
<td>2005.000000</td>
<td>4.000000</td>
<td>8.000000</td>
<td>...</td>
<td>6.000000e+02</td>
<td>3.400000e+02</td>
<td>4.200000e+01</td>
<td>1.000000e+05</td>
<td>1.000000e+05</td>
<td>7.500000e+04</td>
<td>9.917050e+04</td>
<td>1.600000e+04</td>
<td>2.132325e+04</td>
<td>61.989586</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>7.650000e+02</td>
<td>2.000000e+02</td>
<td>18.642500</td>
<td>55.574500</td>
<td>2010.000000</td>
<td>7.000000</td>
<td>15.000000</td>
<td>2010.000000</td>
<td>7.000000</td>
<td>16.000000</td>
<td>...</td>
<td>6.500000e+03</td>
<td>1.966000e+03</td>
<td>1.000000e+03</td>
<td>5.650000e+05</td>
<td>7.023360e+05</td>
<td>2.500000e+05</td>
<td>3.491245e+05</td>
<td>1.000000e+05</td>
<td>1.420280e+05</td>
<td>71.563596</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>4.984000e+03</td>
<td>2.173700e+04</td>
<td>34.786750</td>
<td>103.235250</td>
<td>2018.000000</td>
<td>9.000000</td>
<td>23.000000</td>
<td>2018.000000</td>
<td>9.000000</td>
<td>24.000000</td>
<td>...</td>
<td>6.003500e+04</td>
<td>7.000000e+03</td>
<td>1.757050e+04</td>
<td>3.344000e+06</td>
<td>4.245383e+06</td>
<td>8.000000e+05</td>
<td>1.117445e+06</td>
<td>5.500000e+05</td>
<td>7.172402e+05</td>
<td>80.445779</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>3.518530e+06</td>
<td>4.000000e+07</td>
<td>67.930000</td>
<td>179.650000</td>
<td>2025.000000</td>
<td>12.000000</td>
<td>31.000000</td>
<td>2025.000000</td>
<td>12.000000</td>
<td>31.000000</td>
<td>...</td>
<td>3.300000e+08</td>
<td>5.000000e+06</td>
<td>3.300000e+08</td>
<td>1.000000e+08</td>
<td>1.000000e+08</td>
<td>6.000000e+07</td>
<td>9.361435e+07</td>
<td>2.100000e+08</td>
<td>2.844652e+08</td>
<td>100.000000</td>
</tr>
</tbody>
</table>

<p>8 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<p>Get rid of columns where the data is irrelevant or there’s not enough of it for it to be interesting.</p>
<div id="d58243f1" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Reconstruction Costs, Adjusted ('000 US$)    16176
Reconstruction Costs ('000 US$)              16176
AID Contribution ('000 US$)                  15720
Insured Damage, Adjusted ('000 US$)          15515
Insured Damage ('000 US$)                    15496
River Basin                                  14976
No. Homeless                                 14876
Longitude                                    14393
Latitude                                     14393
External IDs                                 13500
Total Damage, Adjusted ('000 US$)            13099
Total Damage ('000 US$)                      12972
Magnitude                                    12898
Associated Types                             12771
Origin                                       12133
Event Name                                   11104
No. Injured                                  10190
No. Affected                                  8706
Admin Units                                   7793
Magnitude Scale                               6072
Total Affected                                4122
Total Deaths                                  3170
Start Day                                     1571
End Day                                       1499
Location                                       710
CPI                                            682
End Month                                      163
Start Month                                     69
Entry Date                                       0
DisNo.                                           0
End Year                                         0
Start Year                                       0
Historic                                         0
Declaration                                      0
Appeal                                           0
OFDA/BHA Response                                0
Region                                           0
Subregion                                        0
Country                                          0
ISO                                              0
Disaster Subtype                                 0
Disaster Type                                    0
Disaster Subgroup                                0
Disaster Group                                   0
Classification Key                               0
Last Update                                      0
dtype: int64</code></pre>
</div>
</div>
<div id="ed57a53d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[ <span class="st">'DisNo.'</span>, <span class="st">'External IDs'</span>,<span class="st">'Event Name'</span>, <span class="st">'Origin'</span>,<span class="st">'Associated Types'</span>,<span class="st">'Appeal'</span>,<span class="st">'Declaration'</span>,<span class="st">'OFDA/BHA Response'</span>,<span class="st">'AID Contribution (</span><span class="ch">\'</span><span class="st">000 US$)'</span>,  <span class="st">'Reconstruction Costs (</span><span class="ch">\'</span><span class="st">000 US$)'</span>,<span class="st">'Reconstruction Costs, Adjusted (</span><span class="ch">\'</span><span class="st">000 US$)'</span>,<span class="st">'Insured Damage (</span><span class="ch">\'</span><span class="st">000 US$)'</span>,<span class="st">'Insured Damage, Adjusted (</span><span class="ch">\'</span><span class="st">000 US$)'</span>,<span class="st">'River Basin'</span>,<span class="st">'Admin Units'</span>,<span class="st">'Entry Date'</span>,<span class="st">'Last Update'</span>   ], errors<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Historic</th>
<th data-quarto-table-cell-role="th">Classification Key</th>
<th data-quarto-table-cell-role="th">Disaster Group</th>
<th data-quarto-table-cell-role="th">Disaster Subgroup</th>
<th data-quarto-table-cell-role="th">Disaster Type</th>
<th data-quarto-table-cell-role="th">Disaster Subtype</th>
<th data-quarto-table-cell-role="th">ISO</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Subregion</th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">End Month</th>
<th data-quarto-table-cell-role="th">End Day</th>
<th data-quarto-table-cell-role="th">Total Deaths</th>
<th data-quarto-table-cell-role="th">No. Injured</th>
<th data-quarto-table-cell-role="th">No. Affected</th>
<th data-quarto-table-cell-role="th">No. Homeless</th>
<th data-quarto-table-cell-role="th">Total Affected</th>
<th data-quarto-table-cell-role="th">Total Damage ('000 US$)</th>
<th data-quarto-table-cell-role="th">Total Damage, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>DJI</td>
<td>Djibouti</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>100000.0</td>
<td>NaN</td>
<td>100000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>58.111474</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SDN</td>
<td>Sudan</td>
<td>Northern Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2000000.0</td>
<td>NaN</td>
<td>2000000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SOM</td>
<td>Somalia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>21.0</td>
<td>NaN</td>
<td>1200000.0</td>
<td>NaN</td>
<td>1200000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>No</td>
<td>tec-tra-roa-roa</td>
<td>Technological</td>
<td>Transport</td>
<td>Road</td>
<td>Road</td>
<td>AGO</td>
<td>Angola</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>1.0</td>
<td>26.0</td>
<td>14.0</td>
<td>11.0</td>
<td>NaN</td>
<td>NaN</td>
<td>11.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>No</td>
<td>nat-hyd-flo-riv</td>
<td>Natural</td>
<td>Hydrological</td>
<td>Flood</td>
<td>Riverine flood</td>
<td>AGO</td>
<td>Angola</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>1.0</td>
<td>15.0</td>
<td>31.0</td>
<td>NaN</td>
<td>70000.0</td>
<td>NaN</td>
<td>70000.0</td>
<td>10000.0</td>
<td>17695.0</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16204</td>
<td>No</td>
<td>tec-tra-roa-roa</td>
<td>Technological</td>
<td>Transport</td>
<td>Road</td>
<td>Road</td>
<td>BRA</td>
<td>Brazil</td>
<td>Latin America and the Caribbean</td>
<td>Americas</td>
<td>...</td>
<td>4.0</td>
<td>8.0</td>
<td>10.0</td>
<td>18.0</td>
<td>NaN</td>
<td>NaN</td>
<td>18.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16205</td>
<td>No</td>
<td>tec-mis-fir-fir</td>
<td>Technological</td>
<td>Miscellaneous accident</td>
<td>Fire (Miscellaneous)</td>
<td>Fire (Miscellaneous)</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>8.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16206</td>
<td>No</td>
<td>nat-met-sto-san</td>
<td>Natural</td>
<td>Meteorological</td>
<td>Storm</td>
<td>Sand/Dust storm</td>
<td>IRQ</td>
<td>Iraq</td>
<td>Western Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>14.0</td>
<td>NaN</td>
<td>2751.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2751.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16207</td>
<td>No</td>
<td>nat-met-sto-sto</td>
<td>Natural</td>
<td>Meteorological</td>
<td>Storm</td>
<td>Storm (General)</td>
<td>SPI</td>
<td>Canary Islands</td>
<td>Northern Africa</td>
<td>Africa</td>
<td>...</td>
<td>4.0</td>
<td>13.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16208</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SOM</td>
<td>Somalia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4400000.0</td>
<td>NaN</td>
<td>4400000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>16209 rows × 29 columns</p>
</div>
</div>
</div>
<p>Let’s also get rid of data points if it’s missing important variables we care about.</p>
<div id="d4cdccc8" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">'Country'</span>, <span class="st">'Disaster Type'</span>, <span class="st">'Start Year'</span>])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Historic</th>
<th data-quarto-table-cell-role="th">Classification Key</th>
<th data-quarto-table-cell-role="th">Disaster Group</th>
<th data-quarto-table-cell-role="th">Disaster Subgroup</th>
<th data-quarto-table-cell-role="th">Disaster Type</th>
<th data-quarto-table-cell-role="th">Disaster Subtype</th>
<th data-quarto-table-cell-role="th">ISO</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Subregion</th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">End Month</th>
<th data-quarto-table-cell-role="th">End Day</th>
<th data-quarto-table-cell-role="th">Total Deaths</th>
<th data-quarto-table-cell-role="th">No. Injured</th>
<th data-quarto-table-cell-role="th">No. Affected</th>
<th data-quarto-table-cell-role="th">No. Homeless</th>
<th data-quarto-table-cell-role="th">Total Affected</th>
<th data-quarto-table-cell-role="th">Total Damage ('000 US$)</th>
<th data-quarto-table-cell-role="th">Total Damage, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>DJI</td>
<td>Djibouti</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>100000.0</td>
<td>NaN</td>
<td>100000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>58.111474</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SDN</td>
<td>Sudan</td>
<td>Northern Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2000000.0</td>
<td>NaN</td>
<td>2000000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SOM</td>
<td>Somalia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>21.0</td>
<td>NaN</td>
<td>1200000.0</td>
<td>NaN</td>
<td>1200000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>No</td>
<td>tec-tra-roa-roa</td>
<td>Technological</td>
<td>Transport</td>
<td>Road</td>
<td>Road</td>
<td>AGO</td>
<td>Angola</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>1.0</td>
<td>26.0</td>
<td>14.0</td>
<td>11.0</td>
<td>NaN</td>
<td>NaN</td>
<td>11.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>No</td>
<td>nat-hyd-flo-riv</td>
<td>Natural</td>
<td>Hydrological</td>
<td>Flood</td>
<td>Riverine flood</td>
<td>AGO</td>
<td>Angola</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>1.0</td>
<td>15.0</td>
<td>31.0</td>
<td>NaN</td>
<td>70000.0</td>
<td>NaN</td>
<td>70000.0</td>
<td>10000.0</td>
<td>17695.0</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16204</td>
<td>No</td>
<td>tec-tra-roa-roa</td>
<td>Technological</td>
<td>Transport</td>
<td>Road</td>
<td>Road</td>
<td>BRA</td>
<td>Brazil</td>
<td>Latin America and the Caribbean</td>
<td>Americas</td>
<td>...</td>
<td>4.0</td>
<td>8.0</td>
<td>10.0</td>
<td>18.0</td>
<td>NaN</td>
<td>NaN</td>
<td>18.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16205</td>
<td>No</td>
<td>tec-mis-fir-fir</td>
<td>Technological</td>
<td>Miscellaneous accident</td>
<td>Fire (Miscellaneous)</td>
<td>Fire (Miscellaneous)</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>8.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16206</td>
<td>No</td>
<td>nat-met-sto-san</td>
<td>Natural</td>
<td>Meteorological</td>
<td>Storm</td>
<td>Sand/Dust storm</td>
<td>IRQ</td>
<td>Iraq</td>
<td>Western Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>14.0</td>
<td>NaN</td>
<td>2751.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2751.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16207</td>
<td>No</td>
<td>nat-met-sto-sto</td>
<td>Natural</td>
<td>Meteorological</td>
<td>Storm</td>
<td>Storm (General)</td>
<td>SPI</td>
<td>Canary Islands</td>
<td>Northern Africa</td>
<td>Africa</td>
<td>...</td>
<td>4.0</td>
<td>13.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16208</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SOM</td>
<td>Somalia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4400000.0</td>
<td>NaN</td>
<td>4400000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>16209 rows × 29 columns</p>
</div>
</div>
</div>
<p>Get rid of duplicates</p>
<div id="828ef5f4" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop_duplicates()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Historic</th>
<th data-quarto-table-cell-role="th">Classification Key</th>
<th data-quarto-table-cell-role="th">Disaster Group</th>
<th data-quarto-table-cell-role="th">Disaster Subgroup</th>
<th data-quarto-table-cell-role="th">Disaster Type</th>
<th data-quarto-table-cell-role="th">Disaster Subtype</th>
<th data-quarto-table-cell-role="th">ISO</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Subregion</th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">End Month</th>
<th data-quarto-table-cell-role="th">End Day</th>
<th data-quarto-table-cell-role="th">Total Deaths</th>
<th data-quarto-table-cell-role="th">No. Injured</th>
<th data-quarto-table-cell-role="th">No. Affected</th>
<th data-quarto-table-cell-role="th">No. Homeless</th>
<th data-quarto-table-cell-role="th">Total Affected</th>
<th data-quarto-table-cell-role="th">Total Damage ('000 US$)</th>
<th data-quarto-table-cell-role="th">Total Damage, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>DJI</td>
<td>Djibouti</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>100000.0</td>
<td>NaN</td>
<td>100000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>58.111474</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SDN</td>
<td>Sudan</td>
<td>Northern Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2000000.0</td>
<td>NaN</td>
<td>2000000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SOM</td>
<td>Somalia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>21.0</td>
<td>NaN</td>
<td>1200000.0</td>
<td>NaN</td>
<td>1200000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>No</td>
<td>tec-tra-roa-roa</td>
<td>Technological</td>
<td>Transport</td>
<td>Road</td>
<td>Road</td>
<td>AGO</td>
<td>Angola</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>1.0</td>
<td>26.0</td>
<td>14.0</td>
<td>11.0</td>
<td>NaN</td>
<td>NaN</td>
<td>11.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>No</td>
<td>nat-hyd-flo-riv</td>
<td>Natural</td>
<td>Hydrological</td>
<td>Flood</td>
<td>Riverine flood</td>
<td>AGO</td>
<td>Angola</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>1.0</td>
<td>15.0</td>
<td>31.0</td>
<td>NaN</td>
<td>70000.0</td>
<td>NaN</td>
<td>70000.0</td>
<td>10000.0</td>
<td>17695.0</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16204</td>
<td>No</td>
<td>tec-tra-roa-roa</td>
<td>Technological</td>
<td>Transport</td>
<td>Road</td>
<td>Road</td>
<td>BRA</td>
<td>Brazil</td>
<td>Latin America and the Caribbean</td>
<td>Americas</td>
<td>...</td>
<td>4.0</td>
<td>8.0</td>
<td>10.0</td>
<td>18.0</td>
<td>NaN</td>
<td>NaN</td>
<td>18.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16205</td>
<td>No</td>
<td>tec-mis-fir-fir</td>
<td>Technological</td>
<td>Miscellaneous accident</td>
<td>Fire (Miscellaneous)</td>
<td>Fire (Miscellaneous)</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>8.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16206</td>
<td>No</td>
<td>nat-met-sto-san</td>
<td>Natural</td>
<td>Meteorological</td>
<td>Storm</td>
<td>Sand/Dust storm</td>
<td>IRQ</td>
<td>Iraq</td>
<td>Western Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>14.0</td>
<td>NaN</td>
<td>2751.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2751.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16207</td>
<td>No</td>
<td>nat-met-sto-sto</td>
<td>Natural</td>
<td>Meteorological</td>
<td>Storm</td>
<td>Storm (General)</td>
<td>SPI</td>
<td>Canary Islands</td>
<td>Northern Africa</td>
<td>Africa</td>
<td>...</td>
<td>4.0</td>
<td>13.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16208</td>
<td>No</td>
<td>nat-cli-dro-dro</td>
<td>Natural</td>
<td>Climatological</td>
<td>Drought</td>
<td>Drought</td>
<td>SOM</td>
<td>Somalia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4400000.0</td>
<td>NaN</td>
<td>4400000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>16209 rows × 29 columns</p>
</div>
</div>
</div>
</section>
<section id="interesting-variables" class="level2">
<h2 class="anchored" data-anchor-id="interesting-variables">Interesting Variables:</h2>
<ul>
<li>Disaster Type<br>
</li>
<li>Location (country, region, longitude, latitude)</li>
<li>Total Deaths, No.&nbsp;Affected, and No.&nbsp;Injured</li>
<li>Time (start day, start month, etc.)</li>
<li>Cost (Reconstruction Costs and Total Damage)</li>
</ul>
</section>
<section id="research-questions" class="level2">
<h2 class="anchored" data-anchor-id="research-questions">Research Questions:</h2>
<ol type="1">
<li>“Which countries have experienced the highest number of natural disasters in the past 25 years?”</li>
</ol>
<ul>
<li>We’ll need to investigate variables on countries, when it occured, and type of disaster</li>
</ul>
<ol start="2" type="1">
<li>“Are certain types of disasters becoming more common over time?”</li>
</ol>
<ul>
<li>We’ll need to investigate variables on time, when it occured, and type of disaster</li>
<li>Let’s consider limitations with this dataset since it starts in 2000</li>
</ul>
<ol start="3" type="1">
<li>“Can we predict the average number of deaths or affected people for an event based on disaster type and context?”</li>
</ol>
<ul>
<li>We’ll need to investigate variables on Total Deaths, No.&nbsp;Affected, and No.&nbsp;Injured and type of disaster</li>
</ul>
<ol start="4" type="1">
<li>“Can we experiment with data forecasting and predict the number of disasters a country might experience based on its historical trends and geography?”</li>
</ol>
<ul>
<li>We’ll need to investigate variables on type of disaster, when it occured, and location</li>
<li>We’ll need to incorporate another dataset on geography</li>
</ul>
<ol start="5" type="1">
<li>“Can we classify the severity of a disaster based on its type, location, and year?”</li>
</ol>
<ul>
<li>We’ll need to investigate variables on type, location, time, and severity</li>
</ul>
</section>
<section id="tools-needed" class="level2">
<h2 class="anchored" data-anchor-id="tools-needed">Tools Needed</h2>
<ul>
<li>For visualizations, matplotlib, geopanda, seaborn and plotly</li>
<li>For machine learning, specifically forecasting, we can try Scikit-learn for regression or classification models or LSTM</li>
<li>For classification, we can use it to identify patterns or relationships among disasters</li>
</ul>
</section>
<section id="lets-get-started-on-first-research-question" class="level2">
<h2 class="anchored" data-anchor-id="lets-get-started-on-first-research-question">Let’s get started on first research question</h2>
<ol type="1">
<li>“Which countries have experienced the highest number of natural disasters?”</li>
</ol>
<ul>
<li>We’ll need to investigate variables on countries, when it occured, and type of disaster</li>
</ul>
<div id="3bf7a7e7" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>disaster_count_by_country_df <span class="op">=</span> df.groupby([<span class="st">'Country'</span>]).agg(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    disaster_count<span class="op">=</span>(<span class="st">'Disaster Type'</span>, <span class="st">'count'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>).reset_index().sort_values(by<span class="op">=</span><span class="st">'disaster_count'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>disaster_count_by_country_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">disaster_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">39</td>
<td>China</td>
<td>1356</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89</td>
<td>India</td>
<td>820</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">212</td>
<td>United States of America</td>
<td>724</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>Indonesia</td>
<td>565</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">152</td>
<td>Philippines</td>
<td>474</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Anguilla</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">218</td>
<td>Wallis and Futuna Islands</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">164</td>
<td>Saint Helena</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">135</td>
<td>Netherlands Antilles</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>Curaçao</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>222 rows × 2 columns</p>
</div>
</div>
</div>
<div id="10198729" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>pio.renderers.default<span class="op">=</span><span class="st">"iframe"</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    disaster_count_by_country_df.query(<span class="st">'disaster_count&gt;=300'</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Country"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"disaster_count"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"disaster_count"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Country"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    hover_name<span class="op">=</span><span class="st">"Country"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    log_y<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    size_max<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Number of Disaster Types by Country"</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_9.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="analysis-of-first-research-question" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-first-research-question">Analysis of first research question</h2>
<p>From this visualization, we can see that India, China, and the USA have experienced the highest number of natural disasters. This is likely due to their large size, which means that there is more surface area taken into account. Surprising countries are the ones that are smaller but still have faced many natural disasters, such as the Philippines and Nigeria.</p>
</section>
</section>
<section id="week-two-goals" class="level1">
<h1>Week two goals</h1>
<ul>
<li>Answer research question 2. “Are certain types of disasters becoming more common over time?” using visualization and data analysis</li>
<li>Create a visualization to explore relationship between total deaths and occurence count for each disaster subtype</li>
<li>Create an Interactive Map Visualization on Devastating Disasters Around the World</li>
<li>Consider other APIs or Datasets to use that are related to the EM-DAT data but also offer something new and interesting</li>
</ul>
<section id="lets-get-started-on-the-second-research-question" class="level2">
<h2 class="anchored" data-anchor-id="lets-get-started-on-the-second-research-question">Let’s get started on the second research question</h2>
<ol start="2" type="1">
<li>“Are certain types of disasters becoming more common over time?”</li>
</ol>
<ul>
<li><p>We’ll need to investigate variables on time, when it occured, and type of disaster</p></li>
<li><p>Let’s consider limitations with this dataset since it starts in 2000</p></li>
</ul>
<div id="f7004063" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>disaster_counts <span class="op">=</span> df.groupby([<span class="st">'Start Year'</span>, <span class="st">'Disaster Type'</span>]).size().reset_index(name<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>disaster_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Start Year</th>
<th data-quarto-table-cell-role="th">Disaster Type</th>
<th data-quarto-table-cell-role="th">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000</td>
<td>Air</td>
<td>31</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000</td>
<td>Chemical spill</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000</td>
<td>Collapse (Industrial)</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000</td>
<td>Collapse (Miscellaneous)</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000</td>
<td>Drought</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">609</td>
<td>2025</td>
<td>Rail</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">610</td>
<td>2025</td>
<td>Road</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">611</td>
<td>2025</td>
<td>Storm</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">612</td>
<td>2025</td>
<td>Water</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">613</td>
<td>2025</td>
<td>Wildfire</td>
<td>8</td>
</tr>
</tbody>
</table>

<p>614 rows × 3 columns</p>
</div>
</div>
</div>
<div id="8d88bce6" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    disaster_counts,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'Start Year'</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Count'</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'Disaster Type'</span>,  </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Disaster Types Over Time'</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>{<span class="st">'Year'</span>: <span class="st">'Year'</span>, <span class="st">'Count'</span>: <span class="st">'Number of Disasters'</span>},</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_11.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="analysis-of-second-research-question" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-second-research-question">Analysis of second research question</h2>
<p>From this visualization, we can see that it is difficult to answer if there are certain types of disasters becoming more common over time. This is because of our limited data set that starts in the year 2000. To answer, this question, we would need to find data that dates back far enough to see a difference in the frequency of certain disaster types.</p>
</section>
<section id="visualization-to-explore-relationship-between-total-deaths-and-occurence-count-for-each-disaster-subtype" class="level2">
<h2 class="anchored" data-anchor-id="visualization-to-explore-relationship-between-total-deaths-and-occurence-count-for-each-disaster-subtype">Visualization to explore relationship between total deaths and occurence count for each disaster subtype</h2>
<div id="42a0ec1f" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>scatter_data <span class="op">=</span> df.groupby(<span class="st">'Disaster Subtype'</span>).agg(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    total_deaths<span class="op">=</span>(<span class="st">'Total Deaths'</span>, <span class="st">'sum'</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    occurrence_count<span class="op">=</span>(<span class="st">'Disaster Subtype'</span>, <span class="st">'count'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>).reset_index()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>scatter_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Disaster Subtype</th>
<th data-quarto-table-cell-role="th">total_deaths</th>
<th data-quarto-table-cell-role="th">occurrence_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Air</td>
<td>17267.0</td>
<td>439</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Animal incident</td>
<td>12.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Ash fall</td>
<td>663.0</td>
<td>102</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Avalanche (dry)</td>
<td>16.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Avalanche (wet)</td>
<td>1889.0</td>
<td>54</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>Viral disease</td>
<td>47825.0</td>
<td>350</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">59</td>
<td>Volcanic activity (General)</td>
<td>516.0</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>Water</td>
<td>51946.0</td>
<td>1149</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">61</td>
<td>Wildfire (General)</td>
<td>702.0</td>
<td>85</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">62</td>
<td>Worms infestation</td>
<td>0.0</td>
<td>2</td>
</tr>
</tbody>
</table>

<p>63 rows × 3 columns</p>
</div>
</div>
</div>
<div id="4edfa032" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    scatter_data,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'Disaster Subtype'</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'total_deaths'</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'occurrence_count'</span>,    </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'Disaster Subtype'</span>,     </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Disaster Subtypes: Total Deaths vs. Occurrence Count'</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>{</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'disaster_subtype'</span>: <span class="st">'Disaster Subtype'</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'total_deaths'</span>: <span class="st">'Total Deaths'</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_13.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="analysis-of-scatterplot-visualization" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-scatterplot-visualization">Analysis of scatterplot visualization</h2>
<p>We can see that Ground Movement is an outlier and has the highest number of deaths at around 550k. In terms of disaster subtypes with the largest occurence count, we can notice Road, Riverine Flood, Flood, Water, and Tropical Cyclone. We can see that most of these are natural with the exception of Road.</p>
</section>
<section id="map-visualization-on-devastating-disasters-around-the-world" class="level2">
<h2 class="anchored" data-anchor-id="map-visualization-on-devastating-disasters-around-the-world">Map Visualization on Devastating Disasters Around the World</h2>
<div id="21d67e2c" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>map_df <span class="op">=</span> df[(df[<span class="st">'Latitude'</span>].notna()) <span class="op">&amp;</span> (df[<span class="st">'Longitude'</span>].notna())]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>map_df[<span class="st">'Total Deaths'</span>] <span class="op">=</span> map_df[<span class="st">'Total Deaths'</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>map_df <span class="op">=</span> map_df[(map_df[<span class="st">'Total Deaths'</span>] <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>map_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/h6/1nj6sx2s1nxdyfr36bhcxvlc0000gn/T/ipykernel_50407/904054904.py:3: SettingWithCopyWarning:


A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Historic</th>
<th data-quarto-table-cell-role="th">Classification Key</th>
<th data-quarto-table-cell-role="th">Disaster Group</th>
<th data-quarto-table-cell-role="th">Disaster Subgroup</th>
<th data-quarto-table-cell-role="th">Disaster Type</th>
<th data-quarto-table-cell-role="th">Disaster Subtype</th>
<th data-quarto-table-cell-role="th">ISO</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Subregion</th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">End Month</th>
<th data-quarto-table-cell-role="th">End Day</th>
<th data-quarto-table-cell-role="th">Total Deaths</th>
<th data-quarto-table-cell-role="th">No. Injured</th>
<th data-quarto-table-cell-role="th">No. Affected</th>
<th data-quarto-table-cell-role="th">No. Homeless</th>
<th data-quarto-table-cell-role="th">Total Affected</th>
<th data-quarto-table-cell-role="th">Total Damage ('000 US$)</th>
<th data-quarto-table-cell-role="th">Total Damage, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">33</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>1.0</td>
<td>14.0</td>
<td>7.0</td>
<td>2528.0</td>
<td>1760000.0</td>
<td>92479.0</td>
<td>1855007.0</td>
<td>73500.0</td>
<td>130056.0</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>1.0</td>
<td>26.0</td>
<td>1.0</td>
<td>2.0</td>
<td>10300.0</td>
<td>NaN</td>
<td>10302.0</td>
<td>483.0</td>
<td>855.0</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>IRN</td>
<td>Iran (Islamic Republic of)</td>
<td>Southern Asia</td>
<td>Asia</td>
<td>...</td>
<td>2.0</td>
<td>2.0</td>
<td>1.0</td>
<td>15.0</td>
<td>1500.0</td>
<td>500.0</td>
<td>2015.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>COL</td>
<td>Colombia</td>
<td>Latin America and the Caribbean</td>
<td>Americas</td>
<td>...</td>
<td>11.0</td>
<td>8.0</td>
<td>2.0</td>
<td>NaN</td>
<td>430.0</td>
<td>NaN</td>
<td>430.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">208</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>IDN</td>
<td>Indonesia</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>5.0</td>
<td>4.0</td>
<td>45.0</td>
<td>270.0</td>
<td>NaN</td>
<td>52500.0</td>
<td>52770.0</td>
<td>30000.0</td>
<td>53084.0</td>
<td>56.514291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16091</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>1.0</td>
<td>7.0</td>
<td>126.0</td>
<td>188.0</td>
<td>46500.0</td>
<td>NaN</td>
<td>46688.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16099</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>ETH</td>
<td>Ethiopia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>1.0</td>
<td>11.0</td>
<td>2.0</td>
<td>NaN</td>
<td>99000.0</td>
<td>NaN</td>
<td>99000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16184</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>MMR</td>
<td>Myanmar</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>3.0</td>
<td>28.0</td>
<td>3784.0</td>
<td>4824.0</td>
<td>282790.0</td>
<td>NaN</td>
<td>287614.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16185</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>THA</td>
<td>Thailand</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>3.0</td>
<td>28.0</td>
<td>44.0</td>
<td>37.0</td>
<td>2313.0</td>
<td>NaN</td>
<td>2350.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16196</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>TJK</td>
<td>Tajikistan</td>
<td>Central Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>13.0</td>
<td>1.0</td>
<td>NaN</td>
<td>145.0</td>
<td>NaN</td>
<td>145.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>1356 rows × 29 columns</p>
</div>
</div>
</div>
<div id="fd5d35f0" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter_geo(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    map_df,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    lat<span class="op">=</span><span class="st">'Latitude'</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    lon<span class="op">=</span><span class="st">'Longitude'</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'Disaster Subtype'</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">'Total Deaths'</span>,  </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    hover_name<span class="op">=</span><span class="st">'Country'</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Global Disasters Map'</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    size_max<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    geo<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        showland<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        showcountries<span class="op">=</span><span class="va">True</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_15.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="analysis-of-map-visualization" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-map-visualization">Analysis of Map Visualization</h2>
<p>Here, we can see that Haiti experienced a Ground Movement disaster that resulted in a huge amount of deaths. We also see that Indonesia has deathly tsunamis. China, Kazakhstan, and Russia face a lot of floods that have caused a large loss of lives.</p>
</section>
</section>
<section id="week-four-goals" class="level1">
<h1>Week four goals</h1>
<ul>
<li>Respond to questions from research professor prior week</li>
<li>Find interesting environmental API</li>
<li>Obtain API key by creating an account and adding credit card information to subscribe</li>
<li>Testing the API with a simple query</li>
<li>Using the API with interesting parameters</li>
<li>Creating a visualization based on the API</li>
</ul>
<section id="responding-to-questions-from-research-professor-prior-week" class="level2">
<h2 class="anchored" data-anchor-id="responding-to-questions-from-research-professor-prior-week">Responding to questions from research professor prior week</h2>
<ul>
<li>“This is likely due to their large size, which means that there is more surface area taken into account.” -&gt; Would it be possible to apply some normalization techniques to account for differences in country size? -&gt; answer: Great idea! We could try to find another data source that contains the country size and use data techniques to merge it together. Once we’ve prepared the data, we can perform normalization techniques by dividing the number of natural disasters with the corresponding country’s size. We can try doing this during week 5 when we incorporate SQL.</li>
<li>Would you consider numbering the research questions with bullet points to make them easier to reference? -&gt; Yes, I’ll go back and adjust them! This is a great piece of advice</li>
<li>Clarifying question “dataset spans from 2000 to 2025—is that right?” -&gt; answer: Yes, this dataset spans 25 years starting from 2000. Even though there exists data before 2000, according to the data source, “Pre-2000 data is particularly subject to reporting biases.”</li>
<li>Regarding visualizations and figures: Could you ensure consistency in how parameters are represented? For example, if size represents occurrence or death, it would be helpful to maintain that convention across all figures. -&gt; answer: Yes, this is a helpful piece of advice but the reason for the inconsistency in how parameters are represented is due to how these visualizations were more so for exploratory purposes to better understand the data. I’ll keep this advice in mind and ensure consistency in how parameters are represented for the final report.</li>
</ul>
</section>
<section id="air-pollution-dataset-using-api" class="level2">
<h2 class="anchored" data-anchor-id="air-pollution-dataset-using-api">Air Pollution Dataset Using API</h2>
<p>Our data source is called Open Weather Map. I made an account with them and verified my email address to obtain the API key. According to the website, “the Air Pollution API provides current, forecast and historical air pollution data for any coordinates on the globe. Besides basic Air Quality Index, the API returns data about polluting gases, such as Carbon monoxide (CO), Nitrogen monoxide (NO), Nitrogen dioxide (NO2), Ozone (O3), Sulphur dioxide (SO2), Ammonia (NH3), and particulates (PM2.5 and PM10). Air pollution forecast is available for 4 days with hourly granularity. Historical data is accessible from 27th November 2020.”</p>
<ul>
<li><img src="Screenshot 2025-05-12 at 10.00.38 PM.png" alt="Image of a description of OpenWeather scale for Air Quality Index levels:" height="300"></li>
</ul>
<div id="01080ce5" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>API_KEY <span class="op">=</span> <span class="st">"dc622205c25e4f765124ba4c03f370ba"</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>LAT <span class="op">=</span> <span class="fl">35.6764</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>LON <span class="op">=</span> <span class="fl">139.6500</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="ss">f"http://api.openweathermap.org/data/2.5/air_pollution"</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lat"</span>: LAT,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lon"</span>: LON,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"appid"</span>: API_KEY</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> response.json()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Air Quality Index (AQI):"</span>, data[<span class="st">'list'</span>][<span class="dv">0</span>][<span class="st">'main'</span>][<span class="st">'aqi'</span>])</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Components (μg/m³):"</span>, data[<span class="st">'list'</span>][<span class="dv">0</span>][<span class="st">'components'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Air Quality Index (AQI): 1
Components (μg/m³): {'co': 173.01, 'no': 3.6, 'no2': 25.53, 'o3': 50.95, 'so2': 5.56, 'pm2_5': 8.36, 'pm10': 9.88, 'nh3': 0.31}</code></pre>
</div>
</div>
</section>
<section id="air-quality-history" class="level2">
<h2 class="anchored" data-anchor-id="air-quality-history">Air Quality History</h2>
<p>The above code is testing the usage of the API. I looked up the coordinates of Tokyo and plugged that in to obtain the Air Quality Index. I received a value of 2. Now let’s trying using the API to obtain the Air Quality History.</p>
<div id="eec7bf9f" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>API_KEY <span class="op">=</span> <span class="st">"dc622205c25e4f765124ba4c03f370ba"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>LAT <span class="op">=</span> <span class="fl">35.6764</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>LON <span class="op">=</span> <span class="fl">139.6500</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="bu">int</span>(datetime(<span class="dv">2025</span>, <span class="dv">1</span>, <span class="dv">1</span>).timestamp())</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> <span class="bu">int</span>(datetime(<span class="dv">2025</span>, <span class="dv">1</span>, <span class="dv">6</span>).timestamp())  </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"http://api.openweathermap.org/data/2.5/air_pollution/history"</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lat"</span>: LAT,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lon"</span>: LON,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"start"</span>: start,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"end"</span>: end,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"appid"</span>: API_KEY</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> response.json()</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>records <span class="op">=</span> []</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> entry <span class="kw">in</span> data.get(<span class="st">"list"</span>, []):</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    ts <span class="op">=</span> datetime.fromtimestamp(entry[<span class="st">"dt"</span>])</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    aqi <span class="op">=</span> entry[<span class="st">"main"</span>][<span class="st">"aqi"</span>]</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    components <span class="op">=</span> entry[<span class="st">"components"</span>]</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    components[<span class="st">"timestamp"</span>] <span class="op">=</span> ts</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    components[<span class="st">"aqi"</span>] <span class="op">=</span> aqi</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    records.append(components)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(records)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>df.set_index(<span class="st">"timestamp"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         co      no     no2     o3    so2  pm2_5   pm10   nh3  \
timestamp                                                                       
2025-01-01 00:00:00  333.79    0.00   26.73  57.22  19.07   0.86   2.03  1.03   
2025-01-01 01:00:00  323.77    0.00   23.65  59.37  16.45   0.72   1.90  0.95   
2025-01-01 02:00:00  317.10    0.00   22.62  60.80  15.74   0.65   1.91  0.90   
2025-01-01 03:00:00  317.10    0.00   23.31  61.51  16.21   0.67   2.04  0.89   
2025-01-01 04:00:00  323.77    0.00   24.68  60.80  17.40   0.72   2.18  0.93   
...                     ...     ...     ...    ...    ...    ...    ...   ...   
2025-01-05 20:00:00  834.47  236.03  126.12   0.00  72.48  22.26  31.77  3.96   
2025-01-05 21:00:00  741.00  189.54  116.53   0.00  58.65  20.81  28.91  3.64   
2025-01-05 22:00:00  554.08   98.35   98.71   0.00  47.21  16.70  22.60  2.94   
2025-01-05 23:00:00  500.68   75.10   89.11   0.00  40.53  16.16  21.01  2.28   
2025-01-06 00:00:00  480.65   64.37   84.31   0.00  31.47  16.41  20.80  1.63   

                     aqi  
timestamp                 
2025-01-01 00:00:00    1  
2025-01-01 01:00:00    1  
2025-01-01 02:00:00    2  
2025-01-01 03:00:00    2  
2025-01-01 04:00:00    2  
...                  ...  
2025-01-05 20:00:00    3  
2025-01-05 21:00:00    3  
2025-01-05 22:00:00    3  
2025-01-05 23:00:00    3  
2025-01-06 00:00:00    3  

[121 rows x 9 columns]</code></pre>
</div>
</div>
<p>Now that we have our history of the air quality over the past five days at the start of 2025, we can try to categorize it based on https://www.iaqdetectors.com/blogs/what-is-air-quality-index-uba-standardhttps://www.iaqdetectors.com/blogs/what-is-air-quality-index-uba-standard, which says: Level 1: Excellent Air Quality. AQI Range: 1 (Green) Level 2: Good Air Quality. AQI Range: 2 (Green) Level 3: Moderate Air Quality. AQI Range: 3 (Yellow) Level 4: Poor Air Quality. AQI Range: 4 (Orange) Level 5: Very Poor Air Quality. AQI Range: 5 (Red or Purple)</p>
</section>
<section id="categorizing-air-quality" class="level2">
<h2 class="anchored" data-anchor-id="categorizing-air-quality">Categorizing Air Quality</h2>
<div id="47e91a23" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> categorize_aqi(aqi):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> aqi <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Excellent"</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> aqi <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Good"</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> aqi <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Moderate"</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> aqi <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Poor"</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Very Poor"</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"risk_level"</span>] <span class="op">=</span> df[<span class="st">"aqi"</span>].<span class="bu">apply</span>(categorize_aqi)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         co      no     no2     o3    so2  pm2_5   pm10   nh3  \
timestamp                                                                       
2025-01-01 00:00:00  333.79    0.00   26.73  57.22  19.07   0.86   2.03  1.03   
2025-01-01 01:00:00  323.77    0.00   23.65  59.37  16.45   0.72   1.90  0.95   
2025-01-01 02:00:00  317.10    0.00   22.62  60.80  15.74   0.65   1.91  0.90   
2025-01-01 03:00:00  317.10    0.00   23.31  61.51  16.21   0.67   2.04  0.89   
2025-01-01 04:00:00  323.77    0.00   24.68  60.80  17.40   0.72   2.18  0.93   
...                     ...     ...     ...    ...    ...    ...    ...   ...   
2025-01-05 20:00:00  834.47  236.03  126.12   0.00  72.48  22.26  31.77  3.96   
2025-01-05 21:00:00  741.00  189.54  116.53   0.00  58.65  20.81  28.91  3.64   
2025-01-05 22:00:00  554.08   98.35   98.71   0.00  47.21  16.70  22.60  2.94   
2025-01-05 23:00:00  500.68   75.10   89.11   0.00  40.53  16.16  21.01  2.28   
2025-01-06 00:00:00  480.65   64.37   84.31   0.00  31.47  16.41  20.80  1.63   

                     aqi risk_level  
timestamp                            
2025-01-01 00:00:00    1  Excellent  
2025-01-01 01:00:00    1  Excellent  
2025-01-01 02:00:00    2       Good  
2025-01-01 03:00:00    2       Good  
2025-01-01 04:00:00    2       Good  
...                  ...        ...  
2025-01-05 20:00:00    3   Moderate  
2025-01-05 21:00:00    3   Moderate  
2025-01-05 22:00:00    3   Moderate  
2025-01-05 23:00:00    3   Moderate  
2025-01-06 00:00:00    3   Moderate  

[121 rows x 10 columns]</code></pre>
</div>
</div>
</section>
<section id="line-graph-on-air-quality" class="level2">
<h2 class="anchored" data-anchor-id="line-graph-on-air-quality">Line graph on Air Quality</h2>
<p>After, we can visualize the data over the 5 day period!</p>
<div id="92d002f1" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> AQI_Plot(df, start, end, location):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> px.line(df, x<span class="op">=</span>df.index, y<span class="op">=</span><span class="st">"aqi"</span>, title<span class="op">=</span><span class="ss">f"Air Quality Index (AQI) in </span><span class="sc">{</span>location<span class="sc">}</span><span class="ss"> from </span><span class="sc">{</span>start<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>end<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>              labels<span class="op">=</span>{<span class="st">"AQI"</span>: <span class="st">"AQI"</span>, <span class="st">"timestamp"</span>: <span class="st">"Date"</span>})</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    fig.update_traces(line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'blue'</span>))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(yaxis_title<span class="op">=</span><span class="st">"AQI"</span>, xaxis_title<span class="op">=</span><span class="st">"Date"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>AQI_Plot(df, <span class="st">"2025-01-01"</span> ,<span class="st">"2025-01-06"</span>, <span class="st">"Tokyo"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_19.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>However, if we wanted to incorporate the risk levels onto the visualization, we can add some color identification by specifying the color discrete map. The downside is that it is no longer continuous and a little harder to understand since the levels change so dramatically.</p>
<div id="56ee38b8" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> AQI_Color_Plot(df, start, end, location):</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> px.scatter(df, x<span class="op">=</span>df.index, y<span class="op">=</span><span class="st">"aqi"</span>, color<span class="op">=</span><span class="st">"risk_level"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span><span class="ss">f"Air Quality Index (AQI) in </span><span class="sc">{</span>location<span class="sc">}</span><span class="ss"> from </span><span class="sc">{</span>start<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>end<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                    labels<span class="op">=</span>{<span class="st">"aqi"</span>: <span class="st">"AQI"</span>, <span class="st">"timestamp"</span>: <span class="st">"Date"</span>},</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                    color_discrete_map<span class="op">=</span>{</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Excellent"</span>: <span class="st">"green"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Good"</span>: <span class="st">"limegreen"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Moderate"</span>: <span class="st">"orange"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Poor"</span>: <span class="st">"orangered"</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Very Poor"</span>: <span class="st">"red"</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    fig.update_traces(mode<span class="op">=</span><span class="st">"lines+markers"</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(yaxis_title<span class="op">=</span><span class="st">"AQI"</span>, xaxis_title<span class="op">=</span><span class="st">"Date"</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>AQI_Color_Plot(df, <span class="st">"2025-01-01"</span> ,<span class="st">"2025-01-06"</span>, <span class="st">"Tokyo"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_20.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Now let’s wrap everything into a function so that the parameters can be easily changed based on user input.</p>
<div id="6239a4f3" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_df(lat, lon, start, end, location):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    API_KEY <span class="op">=</span> <span class="st">"dc622205c25e4f765124ba4c03f370ba"</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    LAT <span class="op">=</span> lat</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    LON <span class="op">=</span> lon</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> <span class="bu">int</span>(datetime.strptime(start, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>).timestamp())</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    end <span class="op">=</span> <span class="bu">int</span>(datetime.strptime(end, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>).timestamp())</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">"http://api.openweathermap.org/data/2.5/air_pollution/history"</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> {</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"lat"</span>: LAT,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"lon"</span>: LON,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"start"</span>: start,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"end"</span>: end,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"appid"</span>: API_KEY</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url, params<span class="op">=</span>params)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> response.json()</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> []</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> entry <span class="kw">in</span> data.get(<span class="st">"list"</span>, []):</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        ts <span class="op">=</span> datetime.fromtimestamp(entry[<span class="st">"dt"</span>])</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>        aqi <span class="op">=</span> entry[<span class="st">"main"</span>][<span class="st">"aqi"</span>]</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>        components <span class="op">=</span> entry[<span class="st">"components"</span>]</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        components[<span class="st">"timestamp"</span>] <span class="op">=</span> ts</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        components[<span class="st">"aqi"</span>] <span class="op">=</span> aqi</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>        records.append(components)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(records)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        df.set_index(<span class="st">"timestamp"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> categorize_aqi(aqi):</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> aqi <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">"Excellent"</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> aqi <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">"Good"</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> aqi <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">"Moderate"</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> aqi <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">"Poor"</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="st">"Very Poor"</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"risk_level"</span>] <span class="op">=</span> df[<span class="st">"aqi"</span>].<span class="bu">apply</span>(categorize_aqi)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df)</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>    AQI_Color_Plot(df, start, end, location )</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-usage-of-our-function-for-the-specific-location-los-angeles" class="level2">
<h2 class="anchored" data-anchor-id="example-usage-of-our-function-for-the-specific-location-los-angeles">Example usage of our function for the specific location Los Angeles</h2>
<p>Here we are using the coordinates of Los Angeles and observing the air quality between Jan.&nbsp;5 and Jan.&nbsp;10, 2025, which was during the wildfires in the Palisades and Eaton Canyon.</p>
<div id="c59ab3af" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> <span class="fl">34.0549</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>lon <span class="op">=</span> <span class="fl">118.2426</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> <span class="st">"2025-01-05"</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> <span class="st">"2025-01-10"</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>location <span class="op">=</span> <span class="st">"Los Angeles"</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> create_df(lat, lon, start_date, end_date, location)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          co     no    no2     o3    so2   pm2_5    pm10  \
timestamp                                                                  
2025-01-05 00:00:00  1735.69  29.95  58.95   0.00  15.74  173.36  225.51   
2025-01-05 01:00:00  1642.23  29.50  61.01   0.00  14.78  173.32  217.93   
2025-01-05 02:00:00  1562.12  29.50  63.75   0.00  14.90  175.63  215.06   
2025-01-05 03:00:00  1482.01  28.61  67.17   0.00  15.50  178.79  215.36   
2025-01-05 04:00:00  1415.25  25.70  70.60   0.00  16.45  187.26  221.11   
...                      ...    ...    ...    ...    ...     ...     ...   
2025-01-09 20:00:00   614.17   0.02  43.87  33.97  42.92   38.82   61.52   
2025-01-09 21:00:00   620.84   0.02  44.55  32.54  44.82   38.22   61.39   
2025-01-09 22:00:00   647.54   0.04  49.35  28.25  51.98   39.03   61.56   
2025-01-09 23:00:00   754.36   0.14  61.69  17.70  62.94   47.53   71.75   
2025-01-10 00:00:00   834.47   0.31  71.29  11.00  66.76   54.43   79.63   

                      nh3  aqi risk_level  
timestamp                                  
2025-01-05 00:00:00  3.20    5  Very Poor  
2025-01-05 01:00:00  2.03    5  Very Poor  
2025-01-05 02:00:00  1.33    5  Very Poor  
2025-01-05 03:00:00  0.81    5  Very Poor  
2025-01-05 04:00:00  0.34    5  Very Poor  
...                   ...  ...        ...  
2025-01-09 20:00:00  6.46    3   Moderate  
2025-01-09 21:00:00  7.16    3   Moderate  
2025-01-09 22:00:00  7.41    3   Moderate  
2025-01-09 23:00:00  8.61    3   Moderate  
2025-01-10 00:00:00  9.88    4       Poor  

[121 rows x 10 columns]</code></pre>
</div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_22.html" frameborder="0" allowfullscreen=""></iframe>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>None</code></pre>
</div>
</div>
</section>
</section>
<section id="research-questions-1" class="level1">
<h1>Research Questions</h1>
<p>Using this function, a user can pull specific data for an API and create a visualization on the air quality of a chosen location, as well as date range. This would allow them to answer the newly created sixth research question</p>
<ol start="6" type="1">
<li>Over the course of a specific time period in a certain area, how does the air quality change and fluctuate over a rating of 5?</li>
</ol>
<p>This could help them consider whether urban vs rural areas experience different air quality. In addition, it might encourage the user to think about other factors affecting the air quality. For example, from the Los Angeles example, we can understand that a large reason for the bad air quality has to do with the wildfires that begun at the start of this year.</p>
<p>In the future, we can try using to classify pollution levels into health risk categories, such as “Low”, “Moderate”, or “Very Poor”. We can do so by using pollutant concentrations as input and training a classifier like Logistic Regression, Decision Tree, or SVM.</p>
<p>This bring us to our seventh research question which is</p>
<ol start="7" type="1">
<li>How we can try to classify pollution levels into health risk categories using pollutant concentrations?</li>
</ol>
</section>
<section id="week-five-goals" class="level1">
<h1>Week five goals</h1>
<ul>
<li>Normalization techniques to account for differences in country size</li>
<li>Obtain World Population Dataset</li>
<li>SQL to merge the two dataset on countries</li>
<li>Add into column for the square footage of each country</li>
<li>Perform groupby techniques to count the number of disasters and apply mathematical operation to divide by square footage</li>
<li>Create visualization</li>
</ul>
<section id="normalization-techniques-to-account-for-differences-in-country-size" class="level2">
<h2 class="anchored" data-anchor-id="normalization-techniques-to-account-for-differences-in-country-size">Normalization techniques to account for differences in country size</h2>
<p>“This is likely due to their large size, which means that there is more surface area taken into account.” -&gt; Would it be possible to apply some normalization techniques to account for differences in country size? -&gt; answer: Great idea! We could try to find another data source that contains the country size and use data techniques to merge it together. Once we’ve prepared the data, we can perform normalization techniques by dividing the number of natural disasters with the corresponding country’s size.</p>
</section>
<section id="obtain-world-population-dataset" class="level2">
<h2 class="anchored" data-anchor-id="obtain-world-population-dataset">Obtain World Population Dataset</h2>
<p>First thing, we want a dataset on the population of each country. By doing a Google Search, I was able to find one on Kaggle.</p>
<ul>
<li><img src="Screenshot 2025-05-19 at 10.04.00 PM.png" alt="Image of a description of OpenWeather scale for Air Quality Index levels:" height="300"></li>
</ul>
<div id="942ce93b" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_pop <span class="op">=</span> pd.read_csv(<span class="st">'world_population.csv'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Rank</th>
<th data-quarto-table-cell-role="th">CCA3</th>
<th data-quarto-table-cell-role="th">Country/Territory</th>
<th data-quarto-table-cell-role="th">Capital</th>
<th data-quarto-table-cell-role="th">Continent</th>
<th data-quarto-table-cell-role="th">2022 Population</th>
<th data-quarto-table-cell-role="th">2020 Population</th>
<th data-quarto-table-cell-role="th">2015 Population</th>
<th data-quarto-table-cell-role="th">2010 Population</th>
<th data-quarto-table-cell-role="th">2000 Population</th>
<th data-quarto-table-cell-role="th">1990 Population</th>
<th data-quarto-table-cell-role="th">1980 Population</th>
<th data-quarto-table-cell-role="th">1970 Population</th>
<th data-quarto-table-cell-role="th">Area (km²)</th>
<th data-quarto-table-cell-role="th">Density (per km²)</th>
<th data-quarto-table-cell-role="th">Growth Rate</th>
<th data-quarto-table-cell-role="th">World Population Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>36</td>
<td>AFG</td>
<td>Afghanistan</td>
<td>Kabul</td>
<td>Asia</td>
<td>41128771</td>
<td>38972230</td>
<td>33753499</td>
<td>28189672</td>
<td>19542982</td>
<td>10694796</td>
<td>12486631</td>
<td>10752971</td>
<td>652230</td>
<td>63.0587</td>
<td>1.0257</td>
<td>0.52</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>138</td>
<td>ALB</td>
<td>Albania</td>
<td>Tirana</td>
<td>Europe</td>
<td>2842321</td>
<td>2866849</td>
<td>2882481</td>
<td>2913399</td>
<td>3182021</td>
<td>3295066</td>
<td>2941651</td>
<td>2324731</td>
<td>28748</td>
<td>98.8702</td>
<td>0.9957</td>
<td>0.04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>34</td>
<td>DZA</td>
<td>Algeria</td>
<td>Algiers</td>
<td>Africa</td>
<td>44903225</td>
<td>43451666</td>
<td>39543154</td>
<td>35856344</td>
<td>30774621</td>
<td>25518074</td>
<td>18739378</td>
<td>13795915</td>
<td>2381741</td>
<td>18.8531</td>
<td>1.0164</td>
<td>0.56</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>213</td>
<td>ASM</td>
<td>American Samoa</td>
<td>Pago Pago</td>
<td>Oceania</td>
<td>44273</td>
<td>46189</td>
<td>51368</td>
<td>54849</td>
<td>58230</td>
<td>47818</td>
<td>32886</td>
<td>27075</td>
<td>199</td>
<td>222.4774</td>
<td>0.9831</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>203</td>
<td>AND</td>
<td>Andorra</td>
<td>Andorra la Vella</td>
<td>Europe</td>
<td>79824</td>
<td>77700</td>
<td>71746</td>
<td>71519</td>
<td>66097</td>
<td>53569</td>
<td>35611</td>
<td>19860</td>
<td>468</td>
<td>170.5641</td>
<td>1.0100</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>226</td>
<td>WLF</td>
<td>Wallis and Futuna</td>
<td>Mata-Utu</td>
<td>Oceania</td>
<td>11572</td>
<td>11655</td>
<td>12182</td>
<td>13142</td>
<td>14723</td>
<td>13454</td>
<td>11315</td>
<td>9377</td>
<td>142</td>
<td>81.4930</td>
<td>0.9953</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">230</td>
<td>172</td>
<td>ESH</td>
<td>Western Sahara</td>
<td>El Aaiún</td>
<td>Africa</td>
<td>575986</td>
<td>556048</td>
<td>491824</td>
<td>413296</td>
<td>270375</td>
<td>178529</td>
<td>116775</td>
<td>76371</td>
<td>266000</td>
<td>2.1654</td>
<td>1.0184</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">231</td>
<td>46</td>
<td>YEM</td>
<td>Yemen</td>
<td>Sanaa</td>
<td>Asia</td>
<td>33696614</td>
<td>32284046</td>
<td>28516545</td>
<td>24743946</td>
<td>18628700</td>
<td>13375121</td>
<td>9204938</td>
<td>6843607</td>
<td>527968</td>
<td>63.8232</td>
<td>1.0217</td>
<td>0.42</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>63</td>
<td>ZMB</td>
<td>Zambia</td>
<td>Lusaka</td>
<td>Africa</td>
<td>20017675</td>
<td>18927715</td>
<td>16248230</td>
<td>13792086</td>
<td>9891136</td>
<td>7686401</td>
<td>5720438</td>
<td>4281671</td>
<td>752612</td>
<td>26.5976</td>
<td>1.0280</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>74</td>
<td>ZWE</td>
<td>Zimbabwe</td>
<td>Harare</td>
<td>Africa</td>
<td>16320537</td>
<td>15669666</td>
<td>14154937</td>
<td>12839771</td>
<td>11834676</td>
<td>10113893</td>
<td>7049926</td>
<td>5202918</td>
<td>390757</td>
<td>41.7665</td>
<td>1.0204</td>
<td>0.20</td>
</tr>
</tbody>
</table>

<p>234 rows × 17 columns</p>
</div>
</div>
</div>
</section>
<section id="create-and-use-sql-databases-for-data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="create-and-use-sql-databases-for-data-manipulation">Create and Use SQL Databases for Data Manipulation</h2>
<p>So now, we have two seperate databases. One on EMDAT data and the other one containing information of different countries. Because our goal is to apply some normalization techniques to account for differences in country size, we want to use SQL to merge the two databases. Our first step is to import SQL and then start a connection. With this connection, we can convert the two df’s into sql.</p>
<div id="a9fa969b" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"pop.sqlite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="23198543" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sqlite3.<span class="ex">connect</span>(<span class="st">"pop.sqlite"</span>) <span class="im">as</span> conn:</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    df_pop.to_sql(<span class="st">"pop"</span>, conn, if_exists<span class="op">=</span><span class="st">"replace"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    map_df.to_sql(<span class="st">"emdat"</span>, conn, if_exists<span class="op">=</span><span class="st">"replace"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="85aef0aa" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sqlite3.<span class="ex">connect</span>(<span class="st">"pop.sqlite"</span>) <span class="im">as</span> conn:</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    merged_df <span class="op">=</span> pd.read_sql_query(<span class="st">"""</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="st">        SELECT </span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="st">            e.*,</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="st">            p."Area (km²)"</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM </span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="st">            emdat e</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="st">        JOIN </span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="st">            pop p</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="st">        ON </span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="st">            LOWER(e.Country) = LOWER(p."Country/Territory")</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>, conn)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>merged_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Historic</th>
<th data-quarto-table-cell-role="th">Classification Key</th>
<th data-quarto-table-cell-role="th">Disaster Group</th>
<th data-quarto-table-cell-role="th">Disaster Subgroup</th>
<th data-quarto-table-cell-role="th">Disaster Type</th>
<th data-quarto-table-cell-role="th">Disaster Subtype</th>
<th data-quarto-table-cell-role="th">ISO</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Subregion</th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">End Day</th>
<th data-quarto-table-cell-role="th">Total Deaths</th>
<th data-quarto-table-cell-role="th">No. Injured</th>
<th data-quarto-table-cell-role="th">No. Affected</th>
<th data-quarto-table-cell-role="th">No. Homeless</th>
<th data-quarto-table-cell-role="th">Total Affected</th>
<th data-quarto-table-cell-role="th">Total Damage ('000 US$)</th>
<th data-quarto-table-cell-role="th">Total Damage, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">CPI</th>
<th data-quarto-table-cell-role="th">Area (km²)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>14.0</td>
<td>7.0</td>
<td>2528.0</td>
<td>1760000.0</td>
<td>92479.0</td>
<td>1855007.0</td>
<td>73500.0</td>
<td>130056.0</td>
<td>56.514291</td>
<td>9706961</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>26.0</td>
<td>1.0</td>
<td>2.0</td>
<td>10300.0</td>
<td>NaN</td>
<td>10302.0</td>
<td>483.0</td>
<td>855.0</td>
<td>56.514291</td>
<td>9706961</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>COL</td>
<td>Colombia</td>
<td>Latin America and the Caribbean</td>
<td>Americas</td>
<td>...</td>
<td>8.0</td>
<td>2.0</td>
<td>NaN</td>
<td>430.0</td>
<td>NaN</td>
<td>430.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
<td>1141748</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>IDN</td>
<td>Indonesia</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>45.0</td>
<td>270.0</td>
<td>NaN</td>
<td>52500.0</td>
<td>52770.0</td>
<td>30000.0</td>
<td>53084.0</td>
<td>56.514291</td>
<td>1904569</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>IDN</td>
<td>Indonesia</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>4.0</td>
<td>103.0</td>
<td>2714.0</td>
<td>200000.0</td>
<td>2000.0</td>
<td>204714.0</td>
<td>41000.0</td>
<td>72548.0</td>
<td>56.514291</td>
<td>1904569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1127</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>7.0</td>
<td>126.0</td>
<td>188.0</td>
<td>46500.0</td>
<td>NaN</td>
<td>46688.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>9706961</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1128</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>ETH</td>
<td>Ethiopia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>11.0</td>
<td>2.0</td>
<td>NaN</td>
<td>99000.0</td>
<td>NaN</td>
<td>99000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1104300</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1129</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>MMR</td>
<td>Myanmar</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>28.0</td>
<td>3784.0</td>
<td>4824.0</td>
<td>282790.0</td>
<td>NaN</td>
<td>287614.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>676578</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1130</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>THA</td>
<td>Thailand</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>28.0</td>
<td>44.0</td>
<td>37.0</td>
<td>2313.0</td>
<td>NaN</td>
<td>2350.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>513120</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1131</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>TJK</td>
<td>Tajikistan</td>
<td>Central Asia</td>
<td>Asia</td>
<td>...</td>
<td>13.0</td>
<td>1.0</td>
<td>NaN</td>
<td>145.0</td>
<td>NaN</td>
<td>145.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>143100</td>
</tr>
</tbody>
</table>

<p>1132 rows × 30 columns</p>
</div>
</div>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<p>Now we can create the new visualization, but this time, the deaths are normalized by the country size.</p>
<div id="cb728242" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>disaster_counts <span class="op">=</span> merged_df.groupby(<span class="st">'Country'</span>).size().reset_index(name<span class="op">=</span><span class="st">'disaster_count'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>merged_df <span class="op">=</span> merged_df.merge(disaster_counts, on<span class="op">=</span><span class="st">'Country'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>merged_df[<span class="st">'disasters_normalized_by_size'</span>] <span class="op">=</span> <span class="bu">round</span>(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    merged_df[<span class="st">'disaster_count'</span>] <span class="op">/</span> merged_df[<span class="st">'Area (km²)'</span>] <span class="op">*</span> <span class="dv">100000</span>, <span class="dv">2</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c846d69e" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>merged_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Historic</th>
<th data-quarto-table-cell-role="th">Classification Key</th>
<th data-quarto-table-cell-role="th">Disaster Group</th>
<th data-quarto-table-cell-role="th">Disaster Subgroup</th>
<th data-quarto-table-cell-role="th">Disaster Type</th>
<th data-quarto-table-cell-role="th">Disaster Subtype</th>
<th data-quarto-table-cell-role="th">ISO</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Subregion</th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">No. Injured</th>
<th data-quarto-table-cell-role="th">No. Affected</th>
<th data-quarto-table-cell-role="th">No. Homeless</th>
<th data-quarto-table-cell-role="th">Total Affected</th>
<th data-quarto-table-cell-role="th">Total Damage ('000 US$)</th>
<th data-quarto-table-cell-role="th">Total Damage, Adjusted ('000 US$)</th>
<th data-quarto-table-cell-role="th">CPI</th>
<th data-quarto-table-cell-role="th">Area (km²)</th>
<th data-quarto-table-cell-role="th">disaster_count</th>
<th data-quarto-table-cell-role="th">disasters_normalized_by_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>2528.0</td>
<td>1760000.0</td>
<td>92479.0</td>
<td>1855007.0</td>
<td>73500.0</td>
<td>130056.0</td>
<td>56.514291</td>
<td>9706961</td>
<td>114</td>
<td>1.17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>2.0</td>
<td>10300.0</td>
<td>NaN</td>
<td>10302.0</td>
<td>483.0</td>
<td>855.0</td>
<td>56.514291</td>
<td>9706961</td>
<td>114</td>
<td>1.17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>COL</td>
<td>Colombia</td>
<td>Latin America and the Caribbean</td>
<td>Americas</td>
<td>...</td>
<td>NaN</td>
<td>430.0</td>
<td>NaN</td>
<td>430.0</td>
<td>NaN</td>
<td>NaN</td>
<td>56.514291</td>
<td>1141748</td>
<td>18</td>
<td>1.58</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>IDN</td>
<td>Indonesia</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>270.0</td>
<td>NaN</td>
<td>52500.0</td>
<td>52770.0</td>
<td>30000.0</td>
<td>53084.0</td>
<td>56.514291</td>
<td>1904569</td>
<td>101</td>
<td>5.30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>IDN</td>
<td>Indonesia</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>2714.0</td>
<td>200000.0</td>
<td>2000.0</td>
<td>204714.0</td>
<td>41000.0</td>
<td>72548.0</td>
<td>56.514291</td>
<td>1904569</td>
<td>101</td>
<td>5.30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1127</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>CHN</td>
<td>China</td>
<td>Eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>188.0</td>
<td>46500.0</td>
<td>NaN</td>
<td>46688.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>9706961</td>
<td>114</td>
<td>1.17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1128</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>ETH</td>
<td>Ethiopia</td>
<td>Sub-Saharan Africa</td>
<td>Africa</td>
<td>...</td>
<td>NaN</td>
<td>99000.0</td>
<td>NaN</td>
<td>99000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1104300</td>
<td>10</td>
<td>0.91</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1129</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>MMR</td>
<td>Myanmar</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>4824.0</td>
<td>282790.0</td>
<td>NaN</td>
<td>287614.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>676578</td>
<td>13</td>
<td>1.92</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1130</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>THA</td>
<td>Thailand</td>
<td>South-eastern Asia</td>
<td>Asia</td>
<td>...</td>
<td>37.0</td>
<td>2313.0</td>
<td>NaN</td>
<td>2350.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>513120</td>
<td>21</td>
<td>4.09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1131</td>
<td>No</td>
<td>nat-geo-ear-gro</td>
<td>Natural</td>
<td>Geophysical</td>
<td>Earthquake</td>
<td>Ground movement</td>
<td>TJK</td>
<td>Tajikistan</td>
<td>Central Asia</td>
<td>Asia</td>
<td>...</td>
<td>NaN</td>
<td>145.0</td>
<td>NaN</td>
<td>145.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>143100</td>
<td>9</td>
<td>6.29</td>
</tr>
</tbody>
</table>

<p>1132 rows × 32 columns</p>
</div>
</div>
</div>
<div id="71b3c2c5" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>pio.renderers.default<span class="op">=</span><span class="st">"iframe"</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    merged_df.query(<span class="st">'disaster_count'</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Country"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"disaster_count"</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"disasters_normalized_by_size"</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Country"</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    hover_name<span class="op">=</span><span class="st">"Country"</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    log_y<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    size_max<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Number of Disaster Types by Country"</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="545px" src="iframe_figures/figure_29.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
<section id="lets-revist-our-first-research-question" class="level2">
<h2 class="anchored" data-anchor-id="lets-revist-our-first-research-question">Let’s revist our first research question</h2>
<p>Now that we normalized the disaster count by size of the country, we can take a second look at the research question. 1. “Which countries have experienced the highest number of natural disasters?” - We’ll need to investigate variables on countries, when it occured, and type of disaster</p>
</section>
<section id="analysis-of-first-research-question-1" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-first-research-question-1">Analysis of first research question</h2>
<p>From this visualization, we can see that Rwanda, El Savador, and the Philippines have experienced the highest number of natural disasters per 100,000 squared km. Comparing this with the original visualization, we can see that there are differences in the coutnries with the highest numebr of natural diasters where we previously found India, China, and the USA noteworthy due to their large size.</p>
</section>
</section>
<section id="week-six-goals" class="level1">
<h1>Week six goals</h1>
<ul>
<li>Download machine learning imports</li>
<li>Choose dataset for machine learning</li>
<li>Choose selected features for predictor data and for the target</li>
<li>Split the data into train and test groups</li>
<li>Investigate data</li>
<li>Create model using layers</li>
<li>Train the data and make predictions. Then convert them into probabilities using SoftMax</li>
<li>Compile the model, by specifying the loss function and optimization algorithm. Then perform the actual training</li>
</ul>
<section id="download-machine-learning-imports" class="level2">
<h2 class="anchored" data-anchor-id="download-machine-learning-imports">Download machine learning imports</h2>
<div id="60354ec5" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keras</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>keras.__version__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>'3.10.0'</code></pre>
</div>
</div>
</section>
<section id="choose-dataset-for-machine-learning" class="level2">
<h2 class="anchored" data-anchor-id="choose-dataset-for-machine-learning">Choose dataset for machine learning</h2>
<p>Our dataset is multi-spectral values of pixels in 3x3 neighbourhoods in a satellite image, and the classification associated with the central pixel in each neighbourhood. We are using machine learning and 36 data variables to predict the seven types of classes which are:</p>
<p>1 red soil 2 cotton crop 3 grey soil 4 damp grey soil 5 soil with vegetation stubble 6 mixture class (all types present) 7 very damp grey soil</p>
<p>The link to the dataset is: https://archive.ics.uci.edu/dataset/146/statlog+landsat+satellite.</p>
<div id="4dc4b1b2" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://archive.ics.uci.edu/ml/machine-learning-databases/statlog/satimage/sat.trn"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> [<span class="ss">f"feature_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">36</span>)] <span class="op">+</span> [<span class="st">"label"</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(url, sep<span class="op">=</span><span class="st">'</span><span class="ch">\\</span><span class="st">s+'</span>, header<span class="op">=</span><span class="va">None</span>, names<span class="op">=</span>col_names)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop na</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna()</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">"label"</span>, axis<span class="op">=</span><span class="dv">1</span>).astype(np.float32).values <span class="co">#predictor data is everything except label</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">"label"</span>].values <span class="co">#target data is the label</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> le.fit_transform(y)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="investigate-data" class="level2">
<h2 class="anchored" data-anchor-id="investigate-data">Investigate data</h2>
<p>Let’s look at the shape, as well as the first five rows of the predictor data and the target data.</p>
<div id="faa0d374" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>X_train.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>(3104, 36)</code></pre>
</div>
</div>
<div id="ac9f9c5f" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>X_train[:<span class="dv">5</span>] <span class="co"># first five rows of predictor data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([[ 63.,  70.,  72.,  57.,  67.,  77.,  72.,  60.,  71.,  77.,  72.,
         64.,  70.,  75.,  82.,  62.,  70.,  79.,  82.,  65.,  70.,  79.,
         85.,  65.,  68.,  77.,  74.,  61.,  68.,  77.,  78.,  61.,  72.,
         81.,  82.,  65.],
       [ 63.,  67.,  69.,  55.,  63.,  71.,  69.,  55.,  63.,  67.,  73.,
         55.,  67.,  66.,  72.,  53.,  63.,  70.,  68.,  53.,  67.,  70.,
         72.,  57.,  63.,  67.,  70.,  55.,  63.,  71.,  74.,  55.,  63.,
         67.,  74.,  55.],
       [ 75.,  83.,  85.,  71.,  71.,  75.,  85.,  67.,  71.,  79.,  77.,
         67.,  82.,  96., 100.,  81.,  78.,  83.,  84.,  70.,  74.,  75.,
         88.,  66.,  87., 103., 105.,  83.,  79.,  88.,  97.,  72.,  71.,
         81.,  86.,  68.],
       [ 88., 106., 115.,  87.,  88., 111., 111.,  91.,  88., 106., 115.,
         87.,  88., 107., 118.,  92.,  88., 112., 113.,  88.,  88., 103.,
        113.,  88.,  88., 107., 113.,  87.,  88., 107., 104.,  87.,  88.,
        107., 109.,  83.],
       [ 68.,  69.,  86.,  76.,  68.,  69.,  86.,  72.,  68.,  73.,  86.,
         72.,  64.,  71.,  87.,  74.,  64.,  71.,  87.,  78.,  68.,  71.,
         87.,  74.,  67.,  68.,  89.,  79.,  67.,  68.,  89.,  75.,  67.,
         72.,  85.,  71.]], dtype=float32)</code></pre>
</div>
</div>
<div id="03c0e65f" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>y_train[:<span class="dv">5</span>] <span class="co"># first five rows of target data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([5, 5, 5, 2, 4])</code></pre>
</div>
</div>
<div id="aac4ea96" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras <span class="im">import</span> layers</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> keras.models.Sequential([</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    layers.Input((<span class="dv">36</span>,)), </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    layers.Dense(<span class="dv">500</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    layers.Dense(<span class="dv">500</span>, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    layers.Dense(<span class="bu">len</span>(np.unique(y))) </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="57f30a7c" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                    </span>┃<span style="font-weight: bold"> Output Shape           </span>┃<span style="font-weight: bold">       Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ dense (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                   │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">500</span>)            │        <span style="color: #00af00; text-decoration-color: #00af00">18,500</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">500</span>)            │       <span style="color: #00af00; text-decoration-color: #00af00">250,500</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">6</span>)              │         <span style="color: #00af00; text-decoration-color: #00af00">3,006</span> │
└─────────────────────────────────┴────────────────────────┴───────────────┘
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">272,006</span> (1.04 MB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">272,006</span> (1.04 MB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div>
</div>
</section>
<section id="train-the-data-and-make-predictions" class="level2">
<h2 class="anchored" data-anchor-id="train-the-data-and-make-predictions">Train the data and make predictions</h2>
<div id="518d040f" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>model(X_train[:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>&lt;tf.Tensor: shape=(5, 6), dtype=float32, numpy=
array([[ 14.330679 ,  -4.664956 ,  -8.741774 ,  -6.880457 ,   1.873765 ,
         14.979021 ],
       [ 13.455207 ,  -4.072483 ,  -7.892398 ,  -7.3552794,   1.8109777,
         13.604643 ],
       [ 15.390393 ,  -5.3483734, -14.239582 ,  -7.51396  ,   3.959106 ,
         19.957952 ],
       [ 17.20682  ,  -5.180315 , -15.053029 ,  -9.738934 ,   3.3238802,
         21.687113 ],
       [ 11.1366415,  -3.3746386, -10.642702 ,  -7.3522043,   4.175025 ,
         16.877045 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<p>We can apply the softmax layer to transform the data into probabilities.</p>
<div id="b64cbeb7" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>softmax <span class="op">=</span> keras.layers.Softmax()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>softmax(model(X_train[:<span class="dv">5</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>&lt;tf.Tensor: shape=(5, 6), dtype=float32, numpy=
array([[3.43362778e-01, 1.93220573e-09, 3.27728643e-11, 2.10801640e-10,
        1.33593164e-06, 6.56635940e-01],
       [4.62708503e-01, 1.13013012e-08, 2.47834031e-10, 4.24060592e-10,
        4.05772926e-06, 5.37287474e-01],
       [1.02765663e-02, 1.01184998e-11, 1.39223979e-15, 1.16041627e-12,
        1.11507283e-07, 9.89723325e-01],
       [1.12031568e-02, 2.12193175e-12, 1.09412205e-16, 2.22304627e-14,
        1.04726574e-08, 9.88796830e-01],
       [3.20316898e-03, 1.59739166e-09, 1.11411770e-12, 2.99210275e-11,
        3.03520619e-06, 9.96793687e-01]], dtype=float32)&gt;</code></pre>
</div>
</div>
</section>
<section id="compile-the-model-by-specifying-the-loss-function-and-optimization-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="compile-the-model-by-specifying-the-loss-function-and-optimization-algorithm">Compile the model, by specifying the loss function and optimization algorithm</h2>
<div id="f0e99a72" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> keras.losses.SparseCategoricalCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span> <span class="st">"adam"</span>, loss <span class="op">=</span> loss_fn, metrics<span class="op">=</span>[<span class="st">"accuracy"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1984cc3f" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X_train, y_train, epochs <span class="op">=</span> <span class="dv">20</span>,  verbose<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 1s 2ms/step - accuracy: 0.3960 - loss: 18.9771
Epoch 2/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7031 - loss: 0.8707
Epoch 3/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7096 - loss: 0.8774
Epoch 4/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7150 - loss: 0.8075
Epoch 5/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7459 - loss: 0.8138
Epoch 6/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7558 - loss: 0.6525
Epoch 7/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7633 - loss: 0.6328
Epoch 8/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7969 - loss: 0.5224
Epoch 9/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7761 - loss: 0.5531
Epoch 10/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7913 - loss: 0.5354
Epoch 11/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7813 - loss: 0.5683
Epoch 12/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7826 - loss: 0.5241
Epoch 13/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7893 - loss: 0.5272
Epoch 14/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.8069 - loss: 0.4950
Epoch 15/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.8215 - loss: 0.4513
Epoch 16/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.8076 - loss: 0.4766
Epoch 17/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.8012 - loss: 0.4842
Epoch 18/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.8338 - loss: 0.4325
Epoch 19/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.8124 - loss: 0.4657
Epoch 20/20
97/97 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.8049 - loss: 0.4804</code></pre>
</div>
</div>
</section>
<section id="plot-the-progress-of-the-training-over-time" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-progress-of-the-training-over-time">Plot the progress of the training over time</h2>
<p>The training accuracy is improving over time and is hovering at around 80%.</p>
<div id="32efb25d" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">"accuracy"</span>])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>plt.gca().<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"epoch"</span>, ylabel<span class="op">=</span><span class="st">"training accuracy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="evaluate-the-model-on-our-test-data" class="level2">
<h2 class="anchored" data-anchor-id="evaluate-the-model-on-our-test-data">Evaluate the model on our test data</h2>
<p>We’re able to achieve an accuracy of around 80%.</p>
<div id="d0257d01" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>model.evaluate(X_test, y_test, verbose<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>42/42 - 0s - 3ms/step - accuracy: 0.7949 - loss: 0.5223</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>[0.522253692150116, 0.7948910593986511]</code></pre>
</div>
</div>
</section>
<section id="prediction-probabilities" class="level2">
<h2 class="anchored" data-anchor-id="prediction-probabilities">Prediction Probabilities</h2>
<div id="bf4779c8" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>model(X_train[:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>&lt;tf.Tensor: shape=(5, 6), dtype=float32, numpy=
array([[-3.2564087 , -5.2264066 ,  0.77950776,  1.7083402 , -3.5599189 ,
         2.9703608 ],
       [-5.4485703 , -5.5300303 , -1.8344328 ,  0.73341477, -0.48724002,
         3.4024415 ],
       [-3.7386181 , -3.9295647 , -0.08160114,  0.8814881 , -0.9732225 ,
         1.5727332 ],
       [-0.3460873 , -5.9270325 ,  3.452885  ,  1.1476189 , -5.334968  ,
        -1.6315415 ],
       [-3.0256038 , -2.085518  , -3.086216  , -1.4295872 ,  2.5746348 ,
         0.0109342 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="c353518e" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>prob_model <span class="op">=</span> keras.models.Sequential([</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    model,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    layers.Softmax()</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a4aa63a6" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>prob_model(X_train[:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>&lt;tf.Tensor: shape=(5, 6), dtype=float32, numpy=
array([[1.4127031e-03, 1.9701147e-04, 7.9951584e-02, 2.0240161e-01,
        1.0428891e-03, 7.1499419e-01],
       [1.3076646e-04, 1.2053643e-04, 4.8539578e-03, 6.3284606e-02,
        1.8671295e-02, 9.1293889e-01],
       [2.7732656e-03, 2.2912072e-03, 1.0745181e-01, 2.8149977e-01,
        4.4054218e-02, 5.6192970e-01],
       [1.9842867e-02, 7.4787808e-05, 8.8608837e-01, 8.8371612e-02,
        1.3519508e-04, 5.4870476e-03],
       [3.3249243e-03, 8.5124793e-03, 3.1293808e-03, 1.6402991e-02,
        8.9936203e-01, 6.9268137e-02]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="4f904c82" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> prob_model.predict(X_test).argmax(axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 1ms/step </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>array([0, 2, 2, ..., 2, 2, 0])</code></pre>
</div>
</div>
<div id="8fb5c597" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>[le.classes_[predictions[i]] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>[1, 3, 3, 1, 5, 3, 1, 7, 5, 2]</code></pre>
</div>
</div>
</section>
</section>
<section id="week-seven-goals" class="level1">
<h1>Week seven goals</h1>
<ul>
<li>Practice data structure and algorithm concepts related to machine learning</li>
<li>Learn the fundamentals for GO for the first time and practice coding data structures and algorithms in it</li>
<li>Find out what is binary search and how it’s useful in supporting several machine learning tasks, like optimization and search</li>
<li>Learn about decision trees and how to traverse them</li>
<li>Apply BFS and DFS, understand the differences between them</li>
<li>Discover Optimization &amp; Search in Trees</li>
</ul>
<section id="learning-go-as-a-coding-language" class="level2">
<h2 class="anchored" data-anchor-id="learning-go-as-a-coding-language">Learning Go as a Coding Language</h2>
<ul>
<li>high-level general purpose programming language</li>
<li>simple syntax</li>
<li>designed at Google</li>
<li>built-in support for concurrency -&gt; handling multiple tasks simultaneously</li>
<li>used for building cloud-based applications, microservices, and network infrastructure</li>
<li>can be used to create command-line tools</li>
<li>fast build times and tools for monitoring and error -&gt; good for DevOps and SRE roles</li>
</ul>
</section>
<section id="binary-search" class="level2">
<h2 class="anchored" data-anchor-id="binary-search">Binary Search</h2>
<p>Let’s learn what binary search is and how it’s useful in supporting several machine learning tasks, like optimization and search.</p>
<p>Let’s practice this problem using Go: https://leetcode.com/problems/binary-search/</p>
<p>Given an array of integers nums which is sorted in ascending order, and an integer target, write a function to search target in nums. If target exists, then return its index. Otherwise, return -1.</p>
<div id="1579135e" class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>func search(nums []<span class="bu">int</span>, target <span class="bu">int</span>) <span class="bu">int</span> {</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    l <span class="op">:=</span> <span class="dv">0</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    r <span class="op">:=</span> <span class="bu">len</span>(nums) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    var mid <span class="bu">int</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="op">&lt;=</span> r {</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        mid <span class="op">=</span> (r <span class="op">+</span> l) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> nums[mid] <span class="op">&lt;</span> target {</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>            l <span class="op">=</span> mid <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> nums[mid] <span class="op">&gt;</span> target {</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>            r <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mid</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For this problem, we are technique where we are dividing the list by half until we are able to reach the target number. We find the middle number using mid = (r + l) / 2, and then we compare whether this middle number is bigger or smaller than the target number. If it’s the same, we return the index.</p>
</section>
<section id="decision-trees" class="level2">
<h2 class="anchored" data-anchor-id="decision-trees">Decision Trees</h2>
<p>Decision trees are a core component of many ML models, such as Random Forests (multiple decision trees to reduce variance) and Gradient Boosted Trees (ensemble of decision trees, where each tree is sequentially trained to correct the errors of the previous trees).</p>
<section id="tree-traversal" class="level3">
<h3 class="anchored" data-anchor-id="tree-traversal">Tree Traversal</h3>
<p>Tree traverals are important in decision trees, because the type of traversal can help make navigating the tree more efficient. For example, depth-first-search is best at finding the shortest path in an unweighted graph. However, breath-for-search is best at detecting cycles and performing topological sorting.</p>
</section>
<section id="dfs" class="level3">
<h3 class="anchored" data-anchor-id="dfs">DFS</h3>
<p>Let’s practice Binary Tree Inorder Traversal: https://leetcode.com/problems/binary-tree-inorder-traversal/description/</p>
<p>Given the root of a binary tree, return the inorder traversal of its nodes’ values.</p>
<div id="433e751c" class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="op">/**</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> Definition <span class="cf">for</span> a binary tree node.</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> <span class="bu">type</span> TreeNode struct {</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Val <span class="bu">int</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Left <span class="op">*</span>TreeNode</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Right <span class="op">*</span>TreeNode</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> }</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a> <span class="op">*/</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>func inorderTraversal(root <span class="op">*</span>TreeNode) []<span class="bu">int</span> {</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">:=</span> []<span class="bu">int</span>{}</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>    var inorder func(<span class="op">*</span>TreeNode)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>    inorder <span class="op">=</span> func(root <span class="op">*</span>TreeNode){</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> root <span class="op">==</span> nil{</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>        inorder(root.Left)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> append(ans, root.Val)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>        inorder(root.Right)</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>    inorder(root)</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To perform inorder traversal, we use a recursion function to travel down the left side, then print the current value, and then travel down the right side. We keep performing this until we’ve hit every node.</p>
</section>
<section id="bfs" class="level3">
<h3 class="anchored" data-anchor-id="bfs">BFS</h3>
<p>Now let’s try Binary Tree Level Order Traversal: https://leetcode.com/problems/binary-tree-level-order-traversal/description/</p>
<p>Given the root of a binary tree, return the level order traversal of its nodes’ values. (i.e., from left to right, level by level).</p>
<div id="d2d77acf" class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="op">/**</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> Definition <span class="cf">for</span> a binary tree node.</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> <span class="bu">type</span> TreeNode struct {</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Val <span class="bu">int</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Left <span class="op">*</span>TreeNode</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Right <span class="op">*</span>TreeNode</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> }</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a> <span class="op">*/</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>func levelOrder(root <span class="op">*</span>TreeNode) [][]<span class="bu">int</span> {</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> root <span class="op">==</span> nil{</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [][] <span class="bu">int</span>{}</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        var ans [][] <span class="bu">int</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        q <span class="op">:=</span>[]<span class="op">*</span>TreeNode{root}</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="bu">len</span>(q) <span class="op">&gt;</span> <span class="dv">0</span>{</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>            qlen<span class="op">:=</span> <span class="bu">len</span>(q)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>            var temp []<span class="bu">int</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="op">:=</span><span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> qlen<span class="op">;</span> i<span class="op">++</span> {</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>                node <span class="op">:=</span> q[<span class="dv">0</span>]</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>                temp <span class="op">=</span> append(temp, node.Val)</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>                q <span class="op">=</span> q[<span class="dv">1</span>:]</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> node.Left <span class="op">!=</span> nil{</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>                    q <span class="op">=</span> append(q, node.Left)</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> node.Right <span class="op">!=</span> nil{</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>                    q <span class="op">=</span> append(q, node.Right)</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>            ans <span class="op">=</span> append(ans, temp)</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ans</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To perform BFS, we use the data structure called a queue. This is helpful in traveling through the nodes level by level. While there is something in a queue, we keep track of the length and then pop at the first index to access the node. With this node, we store the value and then add the left and right nodes to the queue. Then we add it to the final answer array.</p>
</section>
</section>
<section id="binary-search-tree" class="level2">
<h2 class="anchored" data-anchor-id="binary-search-tree">Binary Search Tree</h2>
<p>Binary Search Trees are helpful for machine learning applications, specifically decision trees and for efficient data handling. They provide useful for lookups, insertions, and deletions when processing and optimizing large datasets.</p>
<p>Let’s try this problem 700. Search in a Binary Search Tree: https://leetcode.com/problems/search-in-a-binary-search-tree/description/</p>
<p>You are given the root of a binary search tree (BST) and an integer val.</p>
<p>Find the node in the BST that the node’s value equals val and return the subtree rooted with that node. If such a node does not exist, return null.</p>
<div id="4a678bd3" class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="op">/**</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> Definition <span class="cf">for</span> a binary tree node.</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> <span class="bu">type</span> TreeNode struct {</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Val <span class="bu">int</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Left <span class="op">*</span>TreeNode</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>     Right <span class="op">*</span>TreeNode</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span> }</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a> <span class="op">*/</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>func searchBST(root <span class="op">*</span>TreeNode, val <span class="bu">int</span>) <span class="op">*</span>TreeNode {</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> root <span class="op">==</span> nil{</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> nil</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">==</span> root.Val{</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> root</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> val <span class="op">&gt;</span> root.Val{</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> searchBST(root.Right, val)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> searchBST(root.Left, val)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For this problem, we are able to use the concept of how values that are smaller than the node are on the left, whereas values that are bigger are on the right. We can keep recursively calling the function with either the left or right node, depending on whether it’s smaller or bigger.</p>
</section>
</section>
<section id="week-eight-goals" class="level1">
<h1>Week eight goals</h1>
<ul>
<li>Find dataset on air quality</li>
<li>Load data and add it to a folder</li>
<li>Add imports</li>
<li>Prepare and clean data</li>
<li>Split data into training and testing</li>
<li>Train random forest model</li>
<li>Create predictions</li>
<li>Evaluate accuracy</li>
<li>Create visualization</li>
</ul>
<p>This week we’ll be focusing on predicting air quality using a random forest model that is made up of 100 decision trees. We’ll also be evaluating accuracy and plotting the predicted vs actual data.</p>
<section id="dataset-1" class="level2">
<h2 class="anchored" data-anchor-id="dataset-1">Dataset</h2>
<p>We’ll be using the UCI Machine Learning Dataset on Air Quality. https://archive.ics.uci.edu/dataset/360/air+quality</p>
<p>“It contains the responses of a gas multisensor device deployed on the field in an Italian city. Hourly responses averages are recorded along with gas concentrations references from a certified analyzer.</p>
<p>The dataset contains 9358 instances of hourly averaged responses from an array of 5 metal oxide chemical sensors embedded in an Air Quality Chemical Multisensor Device. The device was located on the field in a significantly polluted area, at road level,within an Italian city. Data were recorded from March 2004 to February 2005 (one year)representing the longest freely available recordings of on field deployed air quality chemical sensor devices responses. Ground Truth hourly averaged concentrations for CO, Non Metanic Hydrocarbons, Benzene, Total Nitrogen Oxides (NOx) and Nitrogen Dioxide (NO2) and were provided by a co-located reference certified analyzer. Evidences of cross-sensitivities as well as both concept and sensor drifts are present as described in De Vito et al., Sens. And Act. B, Vol. 129,2,2008 (citation required) eventually affecting sensors concentration estimation capabilities. Missing values are tagged with -200 value. This dataset can be used exclusively for research purposes. Commercial purposes are fully excluded.”</p>
</section>
<section id="add-imports" class="level2">
<h2 class="anchored" data-anchor-id="add-imports">Add Imports</h2>
<p>We’re using sklearn Random Forests model and also adding in imports for calculating accuracy.</p>
<div id="1d1d1132" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, mean_absolute_percentage_error, r2_score</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data-and-prepare-and-clean-it" class="level2">
<h2 class="anchored" data-anchor-id="load-data-and-prepare-and-clean-it">Load Data and Prepare and Clean It</h2>
<p>Let’s read in the dataset. First we’ll drop unnamed column names. Then we’ll convert the Date and Time columns into a single one that is formatted in a standardized way. Then we’ll drop NA columns for Datetime. For the missing values, we’ll try to fill them in using linear interpolation, but if it’s not possible then we’ll remove any rows.</p>
<div id="be777696" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'AirQualityUCI.csv'</span>, sep<span class="op">=</span><span class="st">';'</span>, decimal<span class="op">=</span><span class="st">','</span>, na_values<span class="op">=-</span><span class="dv">200</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.loc[:, <span class="op">~</span>df.columns.<span class="bu">str</span>.contains(<span class="st">'^Unnamed'</span>)] </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Datetime'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'Date'</span>] <span class="op">+</span> <span class="st">' '</span> <span class="op">+</span> df[<span class="st">'Time'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y %H.%M.%S'</span>, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>df.dropna(subset<span class="op">=</span>[<span class="st">'Datetime'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>df.set_index(<span class="st">'Datetime'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">'Date'</span>, <span class="st">'Time'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.interpolate(method<span class="op">=</span><span class="st">'linear'</span>).dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a5e39b2f" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">feature_0</th>
<th data-quarto-table-cell-role="th">feature_1</th>
<th data-quarto-table-cell-role="th">feature_2</th>
<th data-quarto-table-cell-role="th">feature_3</th>
<th data-quarto-table-cell-role="th">feature_4</th>
<th data-quarto-table-cell-role="th">feature_5</th>
<th data-quarto-table-cell-role="th">feature_6</th>
<th data-quarto-table-cell-role="th">feature_7</th>
<th data-quarto-table-cell-role="th">feature_8</th>
<th data-quarto-table-cell-role="th">feature_9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">feature_27</th>
<th data-quarto-table-cell-role="th">feature_28</th>
<th data-quarto-table-cell-role="th">feature_29</th>
<th data-quarto-table-cell-role="th">feature_30</th>
<th data-quarto-table-cell-role="th">feature_31</th>
<th data-quarto-table-cell-role="th">feature_32</th>
<th data-quarto-table-cell-role="th">feature_33</th>
<th data-quarto-table-cell-role="th">feature_34</th>
<th data-quarto-table-cell-role="th">feature_35</th>
<th data-quarto-table-cell-role="th">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>92</td>
<td>115</td>
<td>120</td>
<td>94</td>
<td>84</td>
<td>102</td>
<td>106</td>
<td>79</td>
<td>84</td>
<td>102</td>
<td>...</td>
<td>104</td>
<td>88</td>
<td>121</td>
<td>128</td>
<td>100</td>
<td>84</td>
<td>107</td>
<td>113</td>
<td>87</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>84</td>
<td>102</td>
<td>106</td>
<td>79</td>
<td>84</td>
<td>102</td>
<td>102</td>
<td>83</td>
<td>80</td>
<td>102</td>
<td>...</td>
<td>100</td>
<td>84</td>
<td>107</td>
<td>113</td>
<td>87</td>
<td>84</td>
<td>99</td>
<td>104</td>
<td>79</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>84</td>
<td>102</td>
<td>102</td>
<td>83</td>
<td>80</td>
<td>102</td>
<td>102</td>
<td>79</td>
<td>84</td>
<td>94</td>
<td>...</td>
<td>87</td>
<td>84</td>
<td>99</td>
<td>104</td>
<td>79</td>
<td>84</td>
<td>99</td>
<td>104</td>
<td>79</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>80</td>
<td>102</td>
<td>102</td>
<td>79</td>
<td>84</td>
<td>94</td>
<td>102</td>
<td>79</td>
<td>80</td>
<td>94</td>
<td>...</td>
<td>79</td>
<td>84</td>
<td>99</td>
<td>104</td>
<td>79</td>
<td>84</td>
<td>103</td>
<td>104</td>
<td>79</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>84</td>
<td>94</td>
<td>102</td>
<td>79</td>
<td>80</td>
<td>94</td>
<td>98</td>
<td>76</td>
<td>80</td>
<td>102</td>
<td>...</td>
<td>79</td>
<td>84</td>
<td>103</td>
<td>104</td>
<td>79</td>
<td>79</td>
<td>107</td>
<td>109</td>
<td>87</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4430</td>
<td>56</td>
<td>64</td>
<td>108</td>
<td>96</td>
<td>64</td>
<td>71</td>
<td>108</td>
<td>96</td>
<td>68</td>
<td>75</td>
<td>...</td>
<td>92</td>
<td>66</td>
<td>83</td>
<td>108</td>
<td>96</td>
<td>66</td>
<td>87</td>
<td>104</td>
<td>89</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4431</td>
<td>64</td>
<td>71</td>
<td>108</td>
<td>96</td>
<td>68</td>
<td>75</td>
<td>108</td>
<td>96</td>
<td>71</td>
<td>87</td>
<td>...</td>
<td>96</td>
<td>66</td>
<td>87</td>
<td>104</td>
<td>89</td>
<td>63</td>
<td>87</td>
<td>104</td>
<td>89</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4432</td>
<td>68</td>
<td>75</td>
<td>108</td>
<td>96</td>
<td>71</td>
<td>87</td>
<td>108</td>
<td>88</td>
<td>71</td>
<td>91</td>
<td>...</td>
<td>89</td>
<td>63</td>
<td>87</td>
<td>104</td>
<td>89</td>
<td>70</td>
<td>100</td>
<td>104</td>
<td>85</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4433</td>
<td>71</td>
<td>87</td>
<td>108</td>
<td>88</td>
<td>71</td>
<td>91</td>
<td>100</td>
<td>81</td>
<td>76</td>
<td>95</td>
<td>...</td>
<td>89</td>
<td>70</td>
<td>100</td>
<td>104</td>
<td>85</td>
<td>70</td>
<td>91</td>
<td>104</td>
<td>85</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4434</td>
<td>71</td>
<td>91</td>
<td>100</td>
<td>81</td>
<td>76</td>
<td>95</td>
<td>108</td>
<td>88</td>
<td>80</td>
<td>95</td>
<td>...</td>
<td>85</td>
<td>70</td>
<td>91</td>
<td>104</td>
<td>85</td>
<td>63</td>
<td>91</td>
<td>100</td>
<td>81</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>4435 rows × 37 columns</p>
</div>
</div>
</div>
</section>
<section id="create-lag-features" class="level2">
<h2 class="anchored" data-anchor-id="create-lag-features">Create lag features</h2>
<p>Let’s select our predictor variable which is CO(GT). We want to investigate the data by breaking it down into little bits of data that get captured overtime. This will allow us to see how the data fluctuates to best predict future data. We’ll create a new column that capture the CO(GT) levels at every hour.</p>
<div id="876aed92" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>target_col <span class="op">=</span> <span class="st">'CO(GT)'</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>lag_hours <span class="op">=</span> <span class="dv">24</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> lag <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, lag_hours <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="ss">f'</span><span class="sc">{</span>target_col<span class="sc">}</span><span class="ss">_lag_</span><span class="sc">{</span>lag<span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> df[target_col].shift(lag)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a4d869cd" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CO(GT)</th>
<th data-quarto-table-cell-role="th">PT08.S1(CO)</th>
<th data-quarto-table-cell-role="th">NMHC(GT)</th>
<th data-quarto-table-cell-role="th">C6H6(GT)</th>
<th data-quarto-table-cell-role="th">PT08.S2(NMHC)</th>
<th data-quarto-table-cell-role="th">NOx(GT)</th>
<th data-quarto-table-cell-role="th">PT08.S3(NOx)</th>
<th data-quarto-table-cell-role="th">NO2(GT)</th>
<th data-quarto-table-cell-role="th">PT08.S4(NO2)</th>
<th data-quarto-table-cell-role="th">PT08.S5(O3)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_15</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_16</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_17</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_18</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_19</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_20</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_21</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_22</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_23</th>
<th data-quarto-table-cell-role="th">CO(GT)_lag_24</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-03-11 18:00:00</td>
<td>4.8</td>
<td>1581.0</td>
<td>307.0</td>
<td>20.8</td>
<td>1319.0</td>
<td>281.0</td>
<td>799.0</td>
<td>151.0</td>
<td>2083.0</td>
<td>1409.0</td>
<td>...</td>
<td>0.60</td>
<td>0.90</td>
<td>1.00</td>
<td>1.20</td>
<td>1.2</td>
<td>1.6</td>
<td>2.2</td>
<td>2.2</td>
<td>2.0</td>
<td>2.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2004-03-11 19:00:00</td>
<td>6.9</td>
<td>1776.0</td>
<td>461.0</td>
<td>27.4</td>
<td>1488.0</td>
<td>383.0</td>
<td>702.0</td>
<td>172.0</td>
<td>2333.0</td>
<td>1704.0</td>
<td>...</td>
<td>0.65</td>
<td>0.60</td>
<td>0.90</td>
<td>1.00</td>
<td>1.2</td>
<td>1.2</td>
<td>1.6</td>
<td>2.2</td>
<td>2.2</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-03-11 20:00:00</td>
<td>6.1</td>
<td>1640.0</td>
<td>401.0</td>
<td>24.0</td>
<td>1404.0</td>
<td>351.0</td>
<td>743.0</td>
<td>165.0</td>
<td>2191.0</td>
<td>1654.0</td>
<td>...</td>
<td>0.70</td>
<td>0.65</td>
<td>0.60</td>
<td>0.90</td>
<td>1.0</td>
<td>1.2</td>
<td>1.2</td>
<td>1.6</td>
<td>2.2</td>
<td>2.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2004-03-11 21:00:00</td>
<td>3.9</td>
<td>1313.0</td>
<td>197.0</td>
<td>12.8</td>
<td>1076.0</td>
<td>240.0</td>
<td>957.0</td>
<td>136.0</td>
<td>1707.0</td>
<td>1285.0</td>
<td>...</td>
<td>0.70</td>
<td>0.70</td>
<td>0.65</td>
<td>0.60</td>
<td>0.9</td>
<td>1.0</td>
<td>1.2</td>
<td>1.2</td>
<td>1.6</td>
<td>2.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-03-11 22:00:00</td>
<td>1.5</td>
<td>965.0</td>
<td>61.0</td>
<td>4.7</td>
<td>749.0</td>
<td>94.0</td>
<td>1325.0</td>
<td>85.0</td>
<td>1333.0</td>
<td>821.0</td>
<td>...</td>
<td>1.10</td>
<td>0.70</td>
<td>0.70</td>
<td>0.65</td>
<td>0.6</td>
<td>0.9</td>
<td>1.0</td>
<td>1.2</td>
<td>1.2</td>
<td>1.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2005-04-04 10:00:00</td>
<td>3.1</td>
<td>1314.0</td>
<td>275.0</td>
<td>13.5</td>
<td>1101.0</td>
<td>472.0</td>
<td>539.0</td>
<td>190.0</td>
<td>1374.0</td>
<td>1729.0</td>
<td>...</td>
<td>2.70</td>
<td>1.20</td>
<td>1.40</td>
<td>1.30</td>
<td>1.1</td>
<td>1.0</td>
<td>1.0</td>
<td>1.4</td>
<td>1.3</td>
<td>1.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2005-04-04 11:00:00</td>
<td>2.4</td>
<td>1163.0</td>
<td>275.0</td>
<td>11.4</td>
<td>1027.0</td>
<td>353.0</td>
<td>604.0</td>
<td>179.0</td>
<td>1264.0</td>
<td>1269.0</td>
<td>...</td>
<td>2.50</td>
<td>2.70</td>
<td>1.20</td>
<td>1.40</td>
<td>1.3</td>
<td>1.1</td>
<td>1.0</td>
<td>1.0</td>
<td>1.4</td>
<td>1.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2005-04-04 12:00:00</td>
<td>2.4</td>
<td>1142.0</td>
<td>275.0</td>
<td>12.4</td>
<td>1063.0</td>
<td>293.0</td>
<td>603.0</td>
<td>175.0</td>
<td>1241.0</td>
<td>1092.0</td>
<td>...</td>
<td>1.50</td>
<td>2.50</td>
<td>2.70</td>
<td>1.20</td>
<td>1.4</td>
<td>1.3</td>
<td>1.1</td>
<td>1.0</td>
<td>1.0</td>
<td>1.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2005-04-04 13:00:00</td>
<td>2.1</td>
<td>1003.0</td>
<td>275.0</td>
<td>9.5</td>
<td>961.0</td>
<td>235.0</td>
<td>702.0</td>
<td>156.0</td>
<td>1041.0</td>
<td>770.0</td>
<td>...</td>
<td>1.60</td>
<td>1.50</td>
<td>2.50</td>
<td>2.70</td>
<td>1.2</td>
<td>1.4</td>
<td>1.3</td>
<td>1.1</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2005-04-04 14:00:00</td>
<td>2.2</td>
<td>1071.0</td>
<td>275.0</td>
<td>11.9</td>
<td>1047.0</td>
<td>265.0</td>
<td>654.0</td>
<td>168.0</td>
<td>1129.0</td>
<td>816.0</td>
<td>...</td>
<td>1.20</td>
<td>1.60</td>
<td>1.50</td>
<td>2.50</td>
<td>2.7</td>
<td>1.2</td>
<td>1.4</td>
<td>1.3</td>
<td>1.1</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>9333 rows × 37 columns</p>
</div>
</div>
</div>
</section>
<section id="split-into-training-and-test-data" class="level2">
<h2 class="anchored" data-anchor-id="split-into-training-and-test-data">Split into training and test data</h2>
<p>Let’s create a supervised machine learning model that does time series prediction. The input features will be the CO(GT) at each hour for the past day and the target variable is the actual CO(GT). We’ll split the data in such a way that 20% of it will be for testing purposes and the other 80% is for training.</p>
<div id="15f3f345" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[[<span class="ss">f'</span><span class="sc">{</span>target_col<span class="sc">}</span><span class="ss">_lag_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, lag_hours <span class="op">+</span> <span class="dv">1</span>)]]</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[target_col]</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, shuffle<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="train-random-forest-model" class="level2">
<h2 class="anchored" data-anchor-id="train-random-forest-model">Train random forest model</h2>
<p>We’re building 100 decision trees and setting a random seed.</p>
<p>“A random forest is a meta estimator that fits a number of decision tree regressors on various sub-samples of the dataset and uses averaging to improve the predictive accuracy and control over-fitting. Trees in the forest use the best split strategy, i.e.&nbsp;equivalent to passing splitter=”best” to the underlying DecisionTreeRegressor. The sub-sample size is controlled with the max_samples parameter if bootstrap=True (default), otherwise the whole dataset is used to build each tree.”</p>
<div id="8bb718f3" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluate" class="level2">
<h2 class="anchored" data-anchor-id="evaluate">Evaluate</h2>
<p>Let’s figure out the coefficient of determination, the mean absoluate error, the root mean squared error, and the mean absoluate percentage error.</p>
<div id="f9dbdb45" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>mae <span class="op">=</span> mean_absolute_error(y_test, y_pred)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>rmse <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>mape <span class="op">=</span> mean_absolute_percentage_error(y_test, y_pred)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"R² Score: </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"MAE: </span><span class="sc">{</span>mae<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"RMSE: </span><span class="sc">{</span>rmse<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"MAPE: </span><span class="sc">{</span>mape<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Approximate Accuracy: </span><span class="sc">{</span><span class="dv">100</span> <span class="op">-</span> mape <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² Score: 0.8152
MAE: 0.3883
RMSE: 0.5942
MAPE: 29.66%
Approximate Accuracy: 70.34%</code></pre>
</div>
</div>
<p>Based on the evaluation, the random forest model performs decently since it’s able to achieve 70% accuracy.</p>
</section>
<section id="plot-accuracy-by-comparing-predictions-with-real-data" class="level2">
<h2 class="anchored" data-anchor-id="plot-accuracy-by-comparing-predictions-with-real-data">Plot accuracy by comparing predictions with real data</h2>
<p>The orange line represents the predicted data and the blue line represents the actual data.</p>
<div id="dae8a7aa" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>plt.plot(y_test.values, label<span class="op">=</span><span class="st">'Actual CO(GT)'</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>plt.plot(y_pred, label<span class="op">=</span><span class="st">'Predicted CO(GT)'</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Random Forest: CO(GT) Prediction'</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time Step'</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'CO (mg/m³)'</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-61-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="importance-of-predicting-co" class="level2">
<h2 class="anchored" data-anchor-id="importance-of-predicting-co">Importance of predicting CO</h2>
<p>The data we are trying to predict is the true hourly averaged concentration CO in mg/m^3. It’s important to use machine learning to predict CO because carbon monoxide is a greenhouse gas that contributes to air pollution, which can cause acid rain, damage vegetation, and reduce visibility. By learning to accurately predict CO levels, we can develop better environmental protection measures to help counteract against the negative effects. It is crucial for public health and safety.</p>
</section>
</section>
<section id="week-nine-goals" class="level1">
<h1>Week nine goals</h1>
<ul>
<li>Find dataset on crops, specifically the environmental conditions and crop water requirement</li>
<li>Data clean and prep</li>
<li>Select feature and predictor variables</li>
<li>Split data</li>
<li>Perform decision trees</li>
<li>Determine accuracy and plot evaluation of model</li>
</ul>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">Import Data</h2>
<p>I obtained a dataset containing information on crop water requirement. There are 15 different types of crop. For each entry of crop, it’s described by the soil type (dry, humid or wet), a temperature range, weather condition, and region type. It also has details on the water requirement, which is the amount of water that a particular crop needs under certain environmental conditions to grow healthily. We want to predict whether irrigation is necessary. This is important because it can help farmers save time, money, water and also have a good environmental impact.</p>
<p>https://www.kaggle.com/datasets/prateekkkumar/crop-water-requirement/data</p>
<div id="88511732" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'DATASET - Sheet1.csv'</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CROP TYPE</th>
<th data-quarto-table-cell-role="th">SOIL TYPE</th>
<th data-quarto-table-cell-role="th">REGION</th>
<th data-quarto-table-cell-role="th">TEMPERATURE</th>
<th data-quarto-table-cell-role="th">WEATHER CONDITION</th>
<th data-quarto-table-cell-role="th">WATER REQUIREMENT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>BANANA</td>
<td>DRY</td>
<td>DESERT</td>
<td>10-20</td>
<td>NORMAL</td>
<td>8.750</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>BANANA</td>
<td>DRY</td>
<td>DESERT</td>
<td>10-20</td>
<td>SUNNY</td>
<td>10.250</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>BANANA</td>
<td>DRY</td>
<td>DESERT</td>
<td>10-20</td>
<td>WINDY</td>
<td>9.650</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>BANANA</td>
<td>DRY</td>
<td>DESERT</td>
<td>10-20</td>
<td>RAINY</td>
<td>0.750</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>BANANA</td>
<td>DRY</td>
<td>DESERT</td>
<td>20-30</td>
<td>NORMAL</td>
<td>9.850</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2875</td>
<td>ONION</td>
<td>WET</td>
<td>HUMID</td>
<td>30-40</td>
<td>RAINY</td>
<td>0.100</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2876</td>
<td>ONION</td>
<td>WET</td>
<td>HUMID</td>
<td>40-50</td>
<td>NORMAL</td>
<td>4.625</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2877</td>
<td>ONION</td>
<td>WET</td>
<td>HUMID</td>
<td>40-50</td>
<td>SUNNY</td>
<td>6.125</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2878</td>
<td>ONION</td>
<td>WET</td>
<td>HUMID</td>
<td>40-50</td>
<td>WINDY</td>
<td>5.625</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2879</td>
<td>ONION</td>
<td>WET</td>
<td>HUMID</td>
<td>40-50</td>
<td>RAINY</td>
<td>0.200</td>
</tr>
</tbody>
</table>

<p>2880 rows × 6 columns</p>
</div>
</div>
</div>
</section>
<section id="data-cleaning-and-prep" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-prep">Data Cleaning and Prep</h2>
<p>Now it’s time to prep the data. The first thing we want to do is transorm the temperature data from a range into something more readable with one digit. We can do this by creating a function that takes the middle value of the range and applying that to a new column called “TEMPERATURE_NUM”.</p>
<p>The next thing we want to do is to create one-hot encodings for the following columns: ‘CROP TYPE’, ‘SOIL TYPE’, ‘REGION’, ‘WEATHER CONDITION’. This is done to convert each category into a new binary (0 or 1) column. For example, for the column CROP TYPE_BANANA, if it is a banana then the value will be true, or otherwise false. By doing these one-hot encodings, it is easier for the machine to work with the data and understand the features of it.</p>
<p>Now we want to create a column for our predictor data, which will be whether the data entry is bigger than or less than the median of the water requirement—- this will help us determine whether it needs irriation or not. We’re using the median of water requirement as our determinant for needing irrigation, because water requirement is the amount of water that a particular crop needs under certain environmental conditions to grow healthily. So if the water requirement is bigger smaller than the median then it needs irrigation since</p>
<div id="39512376" class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> temp_to_num(temp_range):</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    low, high <span class="op">=</span> temp_range.split(<span class="st">'-'</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="bu">float</span>(low) <span class="op">+</span> <span class="bu">float</span>(high)) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'TEMPERATURE_NUM'</span>] <span class="op">=</span> df[<span class="st">'TEMPERATURE'</span>].<span class="bu">apply</span>(temp_to_num)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>df_encoded <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>[<span class="st">'CROP TYPE'</span>, <span class="st">'SOIL TYPE'</span>, <span class="st">'REGION'</span>, <span class="st">'WEATHER CONDITION'</span>])</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>median_req <span class="op">=</span> df[<span class="st">'WATER REQUIREMENT'</span>].median()</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>df_encoded[<span class="st">'needs_irrigation'</span>] <span class="op">=</span> (df[<span class="st">'WATER REQUIREMENT'</span>] <span class="op">&gt;</span> median_req).astype(<span class="bu">int</span>)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>df_encoded</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TEMPERATURE</th>
<th data-quarto-table-cell-role="th">WATER REQUIREMENT</th>
<th data-quarto-table-cell-role="th">needs_irrigation</th>
<th data-quarto-table-cell-role="th">TEMPERATURE_NUM</th>
<th data-quarto-table-cell-role="th">CROP TYPE_BANANA</th>
<th data-quarto-table-cell-role="th">CROP TYPE_BEAN</th>
<th data-quarto-table-cell-role="th">CROP TYPE_CABBAGE</th>
<th data-quarto-table-cell-role="th">CROP TYPE_CITRUS</th>
<th data-quarto-table-cell-role="th">CROP TYPE_COTTON</th>
<th data-quarto-table-cell-role="th">CROP TYPE_MAIZE</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">SOIL TYPE_HUMID</th>
<th data-quarto-table-cell-role="th">SOIL TYPE_WET</th>
<th data-quarto-table-cell-role="th">REGION_DESERT</th>
<th data-quarto-table-cell-role="th">REGION_HUMID</th>
<th data-quarto-table-cell-role="th">REGION_SEMI ARID</th>
<th data-quarto-table-cell-role="th">REGION_SEMI HUMID</th>
<th data-quarto-table-cell-role="th">WEATHER CONDITION_NORMAL</th>
<th data-quarto-table-cell-role="th">WEATHER CONDITION_RAINY</th>
<th data-quarto-table-cell-role="th">WEATHER CONDITION_SUNNY</th>
<th data-quarto-table-cell-role="th">WEATHER CONDITION_WINDY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10-20</td>
<td>8.750</td>
<td>1</td>
<td>15.0</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10-20</td>
<td>10.250</td>
<td>1</td>
<td>15.0</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>10-20</td>
<td>9.650</td>
<td>1</td>
<td>15.0</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>10-20</td>
<td>0.750</td>
<td>0</td>
<td>15.0</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>20-30</td>
<td>9.850</td>
<td>1</td>
<td>25.0</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2875</td>
<td>30-40</td>
<td>0.100</td>
<td>0</td>
<td>35.0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2876</td>
<td>40-50</td>
<td>4.625</td>
<td>0</td>
<td>45.0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2877</td>
<td>40-50</td>
<td>6.125</td>
<td>1</td>
<td>45.0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2878</td>
<td>40-50</td>
<td>5.625</td>
<td>0</td>
<td>45.0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2879</td>
<td>40-50</td>
<td>0.200</td>
<td>0</td>
<td>45.0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>2880 rows × 30 columns</p>
</div>
</div>
</div>
</section>
<section id="select-feature-columns-and-predictor-column.-then-split-data" class="level2">
<h2 class="anchored" data-anchor-id="select-feature-columns-and-predictor-column.-then-split-data">Select feature columns and predictor column. Then split data</h2>
<p>First we go through all the columns that we performed one-hot encoding on and the temperature, which will form the feature_cols, or input variables. Our y variable is needs_irrigation, which is the data we want to predict.</p>
<p>Then we split the data. 20% will be used for testing, and the rest for training.</p>
<p>Let’s look at the shape of our training data.</p>
<div id="1a561ee8" class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>feature_cols <span class="op">=</span> [<span class="st">'TEMPERATURE_NUM'</span>] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>               [col <span class="cf">for</span> col <span class="kw">in</span> df_encoded.columns <span class="cf">if</span> col.startswith((<span class="st">'CROP TYPE_'</span>, <span class="st">'SOIL TYPE_'</span>, <span class="st">'REGION_'</span>, <span class="st">'WEATHER CONDITION_'</span>))]</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_encoded[feature_cols]</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_encoded[<span class="st">'needs_irrigation'</span>]</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Training samples: </span><span class="sc">{</span><span class="bu">len</span>(X_train)<span class="sc">}</span><span class="ss">, Test samples: </span><span class="sc">{</span><span class="bu">len</span>(X_test)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Features shape:'</span>, X_train.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training samples: 2304, Test samples: 576
Features shape: (2304, 27)</code></pre>
</div>
</div>
</section>
<section id="decision-tree" class="level2">
<h2 class="anchored" data-anchor-id="decision-tree">Decision Tree</h2>
<p>Here we are using a decision tree. We chose a max depth of 7, which means the tree can have at most a depth of 7, or 7 levels. This is done to prevent overfitting, meaning a tree with too many levels might try too hard to capture all the details, leading to poorer acuracy.</p>
<p>Then we fit the model onto our training data and predict whether the crop needs irrigation or not based on features like crop type, soil type, region, weather condition, and temperature.</p>
<div id="a6062b54" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>clf.fit(X_train, y_train)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> clf.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="determine-accuracy">Determine Accuracy</h2>
<div id="2d02b4a0" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.8767361111111112</code></pre>
</div>
</div>
<div id="7ef911fb" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> RocCurveDisplay</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>RocCurveDisplay.from_estimator(clf, X_test, y_test)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-67-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="analysis-of-false-positive-rate-vs-true-positive-rate" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-false-positive-rate-vs-true-positive-rate">Analysis of False Positive Rate vs True Positive Rate</h2>
<p>This ROC curve is a graph that shows the performance of a binary classifier, and the closer it is to 1, the better it is at discrimination. The upward climb to 1 shows that the classifier is getting better and better at obtaining more accurate results.</p>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">Random Forest</h2>
<p>Let’s see if we can improve our performance by using Random Forest instead of decision trees. Random forest is a collection of decision trees.</p>
<div id="e5c0c044" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>rf_clf <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, max_depth<span class="op">=</span><span class="dv">7</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>rf_clf.fit(X_train, y_train)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>rf_pred <span class="op">=</span> rf_clf.predict(X_test)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Random Forest Test Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, rf_pred)<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest Test Accuracy: 0.9010</code></pre>
</div>
</div>
</section>
<section id="now-lets-visually-compare-the-accuracies" class="level2">
<h2 class="anchored" data-anchor-id="now-lets-visually-compare-the-accuracies">Now let’s visually compare the accuracies</h2>
<p>They perform very similarly!</p>
<div id="cee03b5b" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>accuracies <span class="op">=</span> {</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Decision Tree'</span>: accuracy_score(y_test, y_pred),</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Random Forest'</span>: accuracy_score(y_test, rf_pred)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>plt.bar(accuracies.keys(), accuracies.values())</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Accuracy'</span>)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Model Accuracy Comparison'</span>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-69-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="importance-of-results" class="level2">
<h2 class="anchored" data-anchor-id="importance-of-results">Importance of results</h2>
<p>In this research project, we tried predict whether the crop needs irrigation or not based on features like crop type, soil type, region, weather condition, and temperature. We used a decision tree.</p>
<p>Using machine learning and data to determine whether a crop needs irrigation is important because it can be used to help the world: - save water (avoid overwatering and only use irrigation when needed) - environmental sustainability (reduce water run off and soil erosion) - save time and labor (help farmers use their resources wisely) - better crop health (too much water can be bad for the plant)</p>
</section>
<section id="concluding-comments" class="level2">
<h2 class="anchored" data-anchor-id="concluding-comments">Concluding Comments</h2>
<p>Thank you so much Professor Tanaka for your support throughout this project. I’d like to end my final report by going over all the tools I worked with, all the skills I developed, and all the findings I was able to discover.</p>
<section id="tools" class="level3">
<h3 class="anchored" data-anchor-id="tools">Tools</h3>
<p>I was able to learn how to use pandas, plotly, API requests, sql, numpy, sklearn, keras, tensorflow, and matplotlib.</p>
</section>
<section id="skills" class="level3">
<h3 class="anchored" data-anchor-id="skills">Skills</h3>
<p>I was able to learn how to find datasets, import data, perform data cleaning and preparation, create visualizations, send API queries for specific information, create databases using SQL, use SQL to merge datasets, splitting data for training and testing, creating models, training data, making predictions, specifying the loss function and optimization algorithm, learning GO, practicing data structures and algorithsm related to machine learning, learning about decision trees, training random forest model, performing decision trees, and evaluating my models.</p>
</section>
<section id="findings" class="level3">
<h3 class="anchored" data-anchor-id="findings">Findings</h3>
<p>In week one, we set up GitHub, found datasets, created the blog posts structure, and discovered “Which countries have experienced the highest number of natural disasters?”</p>
<p>In week two, we were able to answer the research question “Are certain types of disasters becoming more common over time?” using visualization and data analysis. We also created a visualization to explore relationship between total deaths and occurence count for each disaster subtype. Then we created an Interactive Map Visualization on Devastating Disasters Around the World.</p>
<p>(week three was golden week)</p>
<p>In week four, we used an API to fetch current, forecast and historical air pollution data for any coordinates on the globe. For our example, we used the coordinates of Los Angeles and observe the air quality between Jan.&nbsp;5 and Jan.&nbsp;10, 2025, which was during the wildfires in the Palisades and Eaton Canyon.</p>
<p>In week five, we applied normalization techniques to take a second look at the research question “Which countries have experienced the highest number of natural disasters?” From our newly created visualization, we saw that Rwanda, El Savador, and the Philippines have experienced the highest number of natural disasters per 100,000 squared km.</p>
<p>In week six, we tried classifying the soil structure of multi-spectral values of pixels in 3x3 neighbourhoods in a satellite image. We were able to achieve an accuracy of around 80%.</p>
<p>In week seven, we were able to solve multiple data structure and algorithm problems related to machine learning using GO. We solved Search in a Binary Search Tree, Binary Tree Level Order Traversal, Binary Tree Inorder Traversal, and Binary Search.</p>
<p>In week eight, we tried to predict the true hourly averaged concentration CO in mg/m^3. Our random forest model was able to achieve 70% accuracy.</p>
<p>In week nine, we tried to predict whether the crop needs irrigation or not based on features like crop type, soil type, region, weather condition, and temperature. The decision tree got an accuracy of 87% whereas the random forests got an accuracy of 90%.</p>
</section>
</section>
<section id="reflection" class="level2">
<h2 class="anchored" data-anchor-id="reflection">Reflection</h2>
<p>I’m very proud of this project because I was able to learn lots of useful machine learning and Python skills and perform meaningful research on a variety of environmental topics from soil classification to optimizing water irrigation to predicting carbon monoxide levels to analyzing natural disasters data to fetching real time air quality data. Although the project jumped across many topics and this became less structured, this flexibility helped me explore different datasets and tools. I’m grateful for Professor Tanaka for his support and guidance through the whole project.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/megaminding\.github\.io\/machine_learning_research\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>